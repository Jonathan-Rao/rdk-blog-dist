<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>exceljs（前端导出excel）插件API文档 | DK Rao&#39;s Blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/favicon.ico">
    <meta name="description" content="web前端技术博客,简洁至上,专注web前端学习与总结。JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github等技术文章。">
    <meta name="keywords" content="前端博客,个人技术博客,前端,前端开发,前端框架,web前端,前端面试题,技术文档,学习,面试,JavaScript,js,ES6,TypeScript,vue,python,css3,html5,Node,git,github,markdown">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/assets/css/0.styles.21b825ed.css" as="style"><link rel="preload" href="/assets/js/app.63f7405e.js" as="script"><link rel="preload" href="/assets/js/3.4c003ae3.js" as="script"><link rel="preload" href="/assets/js/2.1e9afdb9.js" as="script"><link rel="preload" href="/assets/js/60.3494f023.js" as="script"><link rel="prefetch" href="/assets/js/1.dc850e31.js"><link rel="prefetch" href="/assets/js/10.5dbbc478.js"><link rel="prefetch" href="/assets/js/100.ff19186b.js"><link rel="prefetch" href="/assets/js/11.87e57194.js"><link rel="prefetch" href="/assets/js/12.4eece6bb.js"><link rel="prefetch" href="/assets/js/13.da88bff8.js"><link rel="prefetch" href="/assets/js/14.617fcb0e.js"><link rel="prefetch" href="/assets/js/15.e90ab816.js"><link rel="prefetch" href="/assets/js/16.217bdacc.js"><link rel="prefetch" href="/assets/js/17.2d36de58.js"><link rel="prefetch" href="/assets/js/18.09321884.js"><link rel="prefetch" href="/assets/js/19.b6545d31.js"><link rel="prefetch" href="/assets/js/20.3c7ccd65.js"><link rel="prefetch" href="/assets/js/21.9f3d9714.js"><link rel="prefetch" href="/assets/js/22.5bcf33e5.js"><link rel="prefetch" href="/assets/js/23.137a28d3.js"><link rel="prefetch" href="/assets/js/24.e9647410.js"><link rel="prefetch" href="/assets/js/25.e2f58923.js"><link rel="prefetch" href="/assets/js/26.dd88bede.js"><link rel="prefetch" href="/assets/js/27.3fa321d4.js"><link rel="prefetch" href="/assets/js/28.ef3548f7.js"><link rel="prefetch" href="/assets/js/29.9d932b65.js"><link rel="prefetch" href="/assets/js/30.3b1344cb.js"><link rel="prefetch" href="/assets/js/31.adb9ef94.js"><link rel="prefetch" href="/assets/js/32.ba3b310d.js"><link rel="prefetch" href="/assets/js/33.490aec31.js"><link rel="prefetch" href="/assets/js/34.3af32dbe.js"><link rel="prefetch" href="/assets/js/35.7ba2c423.js"><link rel="prefetch" href="/assets/js/36.45188d46.js"><link rel="prefetch" href="/assets/js/37.5aa1785c.js"><link rel="prefetch" href="/assets/js/38.2067f88b.js"><link rel="prefetch" href="/assets/js/39.f3777001.js"><link rel="prefetch" href="/assets/js/4.5cdec1e0.js"><link rel="prefetch" href="/assets/js/40.3e57f79d.js"><link rel="prefetch" href="/assets/js/41.6bab86e5.js"><link rel="prefetch" href="/assets/js/42.fc5c7ffb.js"><link rel="prefetch" href="/assets/js/43.882f3619.js"><link rel="prefetch" href="/assets/js/44.e0b4829e.js"><link rel="prefetch" href="/assets/js/45.9a8f29b4.js"><link rel="prefetch" href="/assets/js/46.e135ca80.js"><link rel="prefetch" href="/assets/js/47.a6036de5.js"><link rel="prefetch" href="/assets/js/48.d29a02a9.js"><link rel="prefetch" href="/assets/js/49.c7bc2bd4.js"><link rel="prefetch" href="/assets/js/5.250cdbf8.js"><link rel="prefetch" href="/assets/js/50.0b7f4d01.js"><link rel="prefetch" href="/assets/js/51.75cd77c1.js"><link rel="prefetch" href="/assets/js/52.9a8580a8.js"><link rel="prefetch" href="/assets/js/53.2c4a3f34.js"><link rel="prefetch" href="/assets/js/54.b5925329.js"><link rel="prefetch" href="/assets/js/55.9d030f6c.js"><link rel="prefetch" href="/assets/js/56.e9c1d955.js"><link rel="prefetch" href="/assets/js/57.2f34925d.js"><link rel="prefetch" href="/assets/js/58.a4eadcb3.js"><link rel="prefetch" href="/assets/js/59.25be9a24.js"><link rel="prefetch" href="/assets/js/6.d5177ab6.js"><link rel="prefetch" href="/assets/js/61.57c595c0.js"><link rel="prefetch" href="/assets/js/62.f4e3be21.js"><link rel="prefetch" href="/assets/js/63.e40fa3d1.js"><link rel="prefetch" href="/assets/js/64.1464c9e9.js"><link rel="prefetch" href="/assets/js/65.ff5a9bdd.js"><link rel="prefetch" href="/assets/js/66.846ce21f.js"><link rel="prefetch" href="/assets/js/67.e2b7bec3.js"><link rel="prefetch" href="/assets/js/68.60d17170.js"><link rel="prefetch" href="/assets/js/69.34618919.js"><link rel="prefetch" href="/assets/js/70.fdb34293.js"><link rel="prefetch" href="/assets/js/71.d9d201ba.js"><link rel="prefetch" href="/assets/js/72.3a1c785d.js"><link rel="prefetch" href="/assets/js/73.f3d321c0.js"><link rel="prefetch" href="/assets/js/74.5f33d37c.js"><link rel="prefetch" href="/assets/js/75.281ea73f.js"><link rel="prefetch" href="/assets/js/76.465addf6.js"><link rel="prefetch" href="/assets/js/77.2564b7e8.js"><link rel="prefetch" href="/assets/js/78.a52c2e87.js"><link rel="prefetch" href="/assets/js/79.51c74067.js"><link rel="prefetch" href="/assets/js/80.dc3de84a.js"><link rel="prefetch" href="/assets/js/81.349bec82.js"><link rel="prefetch" href="/assets/js/82.fe3d6458.js"><link rel="prefetch" href="/assets/js/83.fececd3e.js"><link rel="prefetch" href="/assets/js/84.8abd5704.js"><link rel="prefetch" href="/assets/js/85.86950311.js"><link rel="prefetch" href="/assets/js/86.16cb092f.js"><link rel="prefetch" href="/assets/js/87.3e01636c.js"><link rel="prefetch" href="/assets/js/88.028ffdcf.js"><link rel="prefetch" href="/assets/js/89.0d2a51fb.js"><link rel="prefetch" href="/assets/js/9.23dd9dc1.js"><link rel="prefetch" href="/assets/js/90.8a58543f.js"><link rel="prefetch" href="/assets/js/91.eee5d437.js"><link rel="prefetch" href="/assets/js/92.458b922a.js"><link rel="prefetch" href="/assets/js/93.49ce0fe6.js"><link rel="prefetch" href="/assets/js/94.85821361.js"><link rel="prefetch" href="/assets/js/95.046b0fb4.js"><link rel="prefetch" href="/assets/js/96.b56d2320.js"><link rel="prefetch" href="/assets/js/97.7c1df4c9.js"><link rel="prefetch" href="/assets/js/98.7a0e133c.js"><link rel="prefetch" href="/assets/js/99.db916e56.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.db27a015.js">
    <link rel="stylesheet" href="/assets/css/0.styles.21b825ed.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/img/EB-logo.png" alt="DK Rao's Blog" class="logo"> <span class="site-name can-hide">DK Rao's Blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/Jonathan-Rao/rdk-blog-dist" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://Jonathan-Rao.github.io/picx-images-hosting/20251017/f2097d47b248127e.mguj2u7f.jpg"> <div class="blogger-info"><h3>DK Rao</h3> <span>前端界的前行者</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/categories/" class="nav-link">分类</a></div><div class="nav-item"><a href="/tags/" class="nav-link">标签</a></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/archives/" class="nav-link">归档</a></div> <a href="https://github.com/Jonathan-Rao/rdk-blog-dist" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>exceljs（前端导出excel）插件API文档</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/da1a49/#es5-导入⬆" class="sidebar-link">ES5 导入[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#浏览器端⬆" class="sidebar-link">浏览器端[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#创建工作簿⬆" class="sidebar-link">创建工作簿[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#设置工作簿属性⬆" class="sidebar-link">设置工作簿属性[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#设置计算属性⬆" class="sidebar-link">设置计算属性[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#工作簿视图⬆" class="sidebar-link">工作簿视图[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#添加工作表⬆" class="sidebar-link">添加工作表[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#删除工作表⬆" class="sidebar-link">删除工作表[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#访问工作表⬆" class="sidebar-link">访问工作表[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#工作表状态⬆" class="sidebar-link">工作表状态[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#工作表属性⬆" class="sidebar-link">工作表属性[⬆](#目录)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#工作表尺寸⬆" class="sidebar-link">工作表尺寸[⬆](#目录)</a></li></ul></li><li><a href="/pages/da1a49/#页面设置⬆" class="sidebar-link">页面设置[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#页眉和页脚⬆" class="sidebar-link">页眉和页脚[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#工作表视图⬆" class="sidebar-link">工作表视图[⬆](#目录)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#冻结视图⬆" class="sidebar-link">冻结视图[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#拆分视图⬆" class="sidebar-link">拆分视图[⬆](#目录)</a></li></ul></li><li><a href="/pages/da1a49/#自动筛选器⬆" class="sidebar-link">自动筛选器[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#列⬆" class="sidebar-link">列[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#行⬆" class="sidebar-link">行[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#add-rows⬆" class="sidebar-link">Add Rows[⬆](#contents)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#处理单个单元格⬆" class="sidebar-link">处理单个单元格[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#合并单元格⬆" class="sidebar-link">合并单元格[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#insert-rows⬆" class="sidebar-link">Insert Rows[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#splice⬆" class="sidebar-link">Splice[⬆](#contents)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#重复行⬆" class="sidebar-link">重复行[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#定义名称⬆" class="sidebar-link">定义名称[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#数据验证⬆" class="sidebar-link">数据验证[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#单元格注释⬆" class="sidebar-link">单元格注释[⬆](#目录)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#单元格批注属性⬆" class="sidebar-link">单元格批注属性[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#单元格批注页边距⬆" class="sidebar-link">单元格批注页边距[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#已支持的页边距属性⬆" class="sidebar-link">已支持的页边距属性[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#单元格批注保护⬆" class="sidebar-link">单元格批注保护[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#已支持的保护属性⬆" class="sidebar-link">已支持的保护属性[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#单元格批注对象位置属性⬆" class="sidebar-link">单元格批注对象位置属性[⬆](#目录)</a></li></ul></li><li><a href="/pages/da1a49/#表格⬆" class="sidebar-link">表格[⬆](#目录)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#表格属性⬆" class="sidebar-link">表格属性[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#表格样式属性⬆" class="sidebar-link">表格样式属性[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#表格列属性⬆" class="sidebar-link">表格列属性[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#统计函数⬆" class="sidebar-link">统计函数[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#表格样式主题⬆" class="sidebar-link">表格样式主题[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#修改表格⬆" class="sidebar-link">修改表格[⬆](#目录)</a></li></ul></li><li><a href="/pages/da1a49/#样式⬆" class="sidebar-link">样式[⬆](#目录)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#数字格式⬆" class="sidebar-link">数字格式[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#字体" class="sidebar-link">字体</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#对齐⬆" class="sidebar-link">对齐[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#边框⬆" class="sidebar-link">边框[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#填充⬆" class="sidebar-link">填充[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#富文本⬆" class="sidebar-link">富文本[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#单元格保护⬆" class="sidebar-link">单元格保护[⬆](#目录)</a></li></ul></li><li><a href="/pages/da1a49/#条件格式化⬆" class="sidebar-link">条件格式化[⬆](#目录)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#表达式⬆" class="sidebar-link">表达式[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#cell-is⬆" class="sidebar-link">Cell Is[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#top-10⬆" class="sidebar-link">Top 10[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#高于平均值⬆" class="sidebar-link">高于平均值[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#色阶⬆" class="sidebar-link">色阶[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#图标集⬆" class="sidebar-link">图标集[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#数据条⬆" class="sidebar-link">数据条[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#包含文字⬆" class="sidebar-link">包含文字[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#时间段⬆" class="sidebar-link">时间段[⬆](#目录)</a></li></ul></li><li><a href="/pages/da1a49/#大纲级别⬆" class="sidebar-link">大纲级别[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#图片⬆" class="sidebar-link">图片[⬆](#目录)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#将图片添加到工作簿⬆" class="sidebar-link">将图片添加到工作簿[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#将图片添加到工作表背景⬆" class="sidebar-link">将图片添加到工作表背景[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#在一定范围内添加图片⬆" class="sidebar-link">在一定范围内添加图片[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#将图片添加到单元格⬆" class="sidebar-link">将图片添加到单元格[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#添加带有超链接的图片⬆" class="sidebar-link">添加带有超链接的图片[⬆](#目录)</a></li></ul></li><li><a href="/pages/da1a49/#工作表保护⬆" class="sidebar-link">工作表保护[⬆](#目录)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#工作表保护选项⬆" class="sidebar-link">工作表保护选项[⬆](#目录)</a></li></ul></li><li><a href="/pages/da1a49/#文件-i-o⬆" class="sidebar-link">文件 I/O[⬆](#目录)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#xlsx⬆" class="sidebar-link">XLSX[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#csv⬆" class="sidebar-link">CSV[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#流式-i-o⬆" class="sidebar-link">流式 I/O[⬆](#目录)</a></li></ul></li><li><a href="/pages/da1a49/#预捆绑⬆" class="sidebar-link">预捆绑[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#null-值⬆" class="sidebar-link">Null 值[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#合并单元格⬆-2" class="sidebar-link">合并单元格[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#数字值⬆" class="sidebar-link">数字值[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#字符串值⬆" class="sidebar-link">字符串值[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#日期值⬆" class="sidebar-link">日期值[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#超链接值⬆" class="sidebar-link">超链接值[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#公式值⬆" class="sidebar-link">公式值[⬆](#目录)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#共享公式⬆" class="sidebar-link">共享公式[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#公式类型⬆" class="sidebar-link">公式类型[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#数组公式⬆" class="sidebar-link">数组公式[⬆](#目录)</a></li></ul></li><li><a href="/pages/da1a49/#富文本值⬆" class="sidebar-link">富文本值[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#布尔值⬆" class="sidebar-link">布尔值[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#错误值⬆" class="sidebar-link">错误值[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#_0-1-0⬆" class="sidebar-link">0.1.0[⬆](#目录)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#worksheet-eachrow⬆" class="sidebar-link">Worksheet.eachRow[⬆](#目录)</a></li><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#worksheet-getrow⬆" class="sidebar-link">Worksheet.getRow[⬆](#目录)</a></li></ul></li><li><a href="/pages/da1a49/#_0-1-1⬆" class="sidebar-link">0.1.1[⬆](#目录)</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/pages/da1a49/#cell-model⬆" class="sidebar-link">cell.model[⬆](#目录)</a></li></ul></li><li><a href="/pages/da1a49/#_0-2-44⬆" class="sidebar-link">0.2.44[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#dist-文件夹⬆" class="sidebar-link">Dist 文件夹[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#使用-puppeteer-进行测试⬆" class="sidebar-link">使用 Puppeteer 进行测试[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/da1a49/#拼接与合并⬆" class="sidebar-link">拼接与合并[⬆](#目录)</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><!----> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/Jonathan-Rao" target="_blank" title="作者" class="beLink" data-v-06225672>DK Rao</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-03-24</a></div> <div title="分类" class="date iconfont icon-wenjian" data-v-06225672><a href="/categories/?category=%E5%89%8D%E7%AB%AF" data-v-06225672>前端 </a><a href="/categories/?category=API%E6%96%87%E6%A1%A3" data-v-06225672>API文档 </a></div></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">exceljs（前端导出excel）插件API文档<!----></h1> <!----> <div class="theme-vdoing-content content__default"><h1 id="exceljs"><a href="#exceljs" class="header-anchor">#</a> ExcelJS</h1> <p><a href="https://github.com/exceljs/exceljs/actions?query=workflow%3AExcelJS" target="_blank" rel="noopener noreferrer"><img src="https://github.com/exceljs/exceljs/workflows/ExcelJS/badge.svg" alt="Build status"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://lgtm.com/projects/g/exceljs/exceljs/context:javascript" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/lgtm/grade/javascript/g/exceljs/exceljs.svg?logo=lgtm&amp;logoWidth=18" alt="Code Quality: Javascript"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> <a href="https://lgtm.com/projects/g/exceljs/exceljs/alerts" target="_blank" rel="noopener noreferrer"><img src="https://img.shields.io/lgtm/alerts/g/exceljs/exceljs.svg?logo=lgtm&amp;logoWidth=18" alt="Total Alerts"><span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>读取，操作并写入电子表格数据和样式到 XLSX 和 JSON 文件。</p> <p>一个 Excel 电子表格文件逆向工程项目。</p> <h1 id="安装"><a href="#安装" class="header-anchor">#</a> 安装</h1> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">npm</span> <span class="token function">install</span> exceljs
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h1 id="新的功能"><a href="#新的功能" class="header-anchor">#</a> 新的功能!</h1> <ul><li>
    重大版本更改-主要的ExcelJS接口已从基于流的API迁移到异步迭代器，从而使代码更简洁。 虽然技术上是一个突破性的变化，但大多数API都没有变化，详细信息请参见<a href="https://github.com/exceljs/exceljs/blob/master/UPGRADE-4.0.md">UPGRADE-4.0.md</a>。
  </li> <li>
    此升级来自以下合并：
     <ul><li><a href="https://github.com/exceljs/exceljs/pull/1135">[MAJOR VERSION] Async iterators #1135</a></li> <li><a href="https://github.com/exceljs/exceljs/pull/1142">[MAJOR VERSION] Move node v8 support to ES5 imports #1142</a></li></ul>
    团队做了很多工作-特别是 <a href="https://github.com/alubbe">Andreas Lubbe</a> and
    <a href="https://github.com/Siemienik">Siemienik Paweł</a>.
  </li></ul> <h1 id="贡献"><a href="#贡献" class="header-anchor">#</a> 贡献</h1> <p>欢迎贡献！这可以帮助我了解大家需要一些什么功能，或者哪些 bugs 造成了极大的麻烦。</p> <p>我只有一个请求；如果您提交对错误修复的请求（PR），请添加一个能够解决问题的单元测试或集成测试（在 <em>spec</em> 文件夹中）。
即使只是测试失败的请求（PR）也可以 - 我可以分析测试的过程并以此修复代码。</p> <p>注意：请尽可能避免在请求（PR）中修改软件包版本。
版本一般在发布时会进行更新，任何版本更改很可能导致合并冲突。</p> <p>明确地说，添加到该库的所有贡献都将包含在该库的 MIT 许可证中。</p> <h1 id="导入⬆"><a href="#导入⬆" class="header-anchor">#</a> 导入<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h1> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> ExcelJS <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'exceljs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="es5-导入⬆"><a href="#es5-导入⬆" class="header-anchor">#</a> ES5 导入<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>要使用 ES5 编译代码，请使用 <em>dist/es5</em> 路径。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> ExcelJS <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'exceljs/dist/es5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>**注意：**ES5 版本对许多 polyfill 都具有隐式依赖，而 exceljs 不再明确添加。
您需要在依赖项中添加 <code>core-js</code> 和 <code>regenerator-runtime</code>，并在导入 <code>exceljs</code> 之前在代码中包含以下引用：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// exceljs 所需的 polyfills</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'core-js/modules/es.promise'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'core-js/modules/es.string.includes'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'core-js/modules/es.object.assign'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'core-js/modules/es.object.keys'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'core-js/modules/es.symbol'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'core-js/modules/es.symbol.async-iterator'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'regenerator-runtime/runtime'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> ExcelJS <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'exceljs/dist/es5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>对于 IE 11，您还需要一个 polyfill 以支持 unicode regex 模式。 例如，</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> rewritePattern <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'regexpu-core'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span>generateRegexpuOptions<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'@babel/helper-create-regexp-features-plugin/lib/util'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{</span>RegExp<span class="token punctuation">}</span> <span class="token operator">=</span> global<span class="token punctuation">;</span>
<span class="token keyword">try</span> <span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'u'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  global<span class="token punctuation">.</span><span class="token function-variable function">RegExp</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">pattern<span class="token punctuation">,</span> flags</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>flags <span class="token operator">&amp;&amp;</span> flags<span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span><span class="token string">'u'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token function">rewritePattern</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> flags<span class="token punctuation">,</span> <span class="token function">generateRegexpuOptions</span><span class="token punctuation">(</span><span class="token punctuation">{</span>flags<span class="token punctuation">,</span> pattern<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span>pattern<span class="token punctuation">,</span> flags<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  global<span class="token punctuation">.</span><span class="token class-name">RegExp</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token class-name">RegExp</span><span class="token punctuation">.</span>prototype<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="浏览器端⬆"><a href="#浏览器端⬆" class="header-anchor">#</a> 浏览器端<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>ExcelJS 在 <em>dist/</em> 文件夹内发布了两个支持浏览器的包：</p> <p>一个是隐式依赖 <code>core-js</code> polyfills 的...</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.26.0/polyfill.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>exceljs.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>另一个则没有...</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>--your-project's-pollyfills-here--<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>exceljs.bare.js<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h1 id="接口⬆"><a href="#接口⬆" class="header-anchor">#</a> 接口<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h1> <h2 id="创建工作簿⬆"><a href="#创建工作簿⬆" class="header-anchor">#</a> 创建工作簿<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="设置工作簿属性⬆"><a href="#设置工作簿属性⬆" class="header-anchor">#</a> 设置工作簿属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>workbook<span class="token punctuation">.</span>creator <span class="token operator">=</span> <span class="token string">'Me'</span><span class="token punctuation">;</span>
workbook<span class="token punctuation">.</span>lastModifiedBy <span class="token operator">=</span> <span class="token string">'Her'</span><span class="token punctuation">;</span>
workbook<span class="token punctuation">.</span>created <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">1985</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
workbook<span class="token punctuation">.</span>modified <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
workbook<span class="token punctuation">.</span>lastPrinted <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">2016</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token number">27</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 将工作簿日期设置为 1904 年日期系统</span>
workbook<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>date1904 <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="设置计算属性⬆"><a href="#设置计算属性⬆" class="header-anchor">#</a> 设置计算属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 在加载时强制工作簿计算属性</span>
workbook<span class="token punctuation">.</span>calcProperties<span class="token punctuation">.</span>fullCalcOnLoad <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="工作簿视图⬆"><a href="#工作簿视图⬆" class="header-anchor">#</a> 工作簿视图<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>工作簿视图控制在查看工作簿时 Excel 将打开多少个单独的窗口。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>workbook<span class="token punctuation">.</span>views <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span>
    <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">10000</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">20000</span><span class="token punctuation">,</span>
    <span class="token literal-property property">firstSheet</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">activeTab</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">visibility</span><span class="token operator">:</span> <span class="token string">'visible'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="添加工作表⬆"><a href="#添加工作表⬆" class="header-anchor">#</a> 添加工作表<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'My Sheet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>使用 <code>addWorksheet</code> 函数的第二个参数来指定工作表的选项。</p> <p>示例：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 创建带有红色标签颜色的工作表</span>
<span class="token keyword">const</span> sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'My Sheet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">properties</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">tabColor</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FFC0000'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建一个隐藏了网格线的工作表</span>
<span class="token keyword">const</span> sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'My Sheet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">views</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token literal-property property">showGridLines</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建一个第一行和列冻结的工作表</span>
<span class="token keyword">const</span> sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'My Sheet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">views</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token literal-property property">xSplit</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">ySplit</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用A4设置的页面设置设置创建新工作表 - 横向</span>
<span class="token keyword">const</span> worksheet <span class="token operator">=</span>  workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'My Sheet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">pageSetup</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">paperSize</span><span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token literal-property property">orientation</span><span class="token operator">:</span><span class="token string">'landscape'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建一个具有页眉页脚的工作表</span>
<span class="token keyword">const</span> sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'My Sheet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">headerFooter</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">firstHeader</span><span class="token operator">:</span> <span class="token string">&quot;Hello Exceljs&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">firstFooter</span><span class="token operator">:</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建一个冻结了第一行和第一列的工作表</span>
<span class="token keyword">const</span> sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'My Sheet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">views</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token string">'frozen'</span><span class="token punctuation">,</span> <span class="token literal-property property">xSplit</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">ySplit</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="删除工作表⬆"><a href="#删除工作表⬆" class="header-anchor">#</a> 删除工作表<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>使用工作表的  <code>id</code> 从工作簿中删除工作表。</p> <p>示例：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 创建工作表</span>
<span class="token keyword">const</span> sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'My Sheet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用工作表 id 删除工作表</span>
workbook<span class="token punctuation">.</span><span class="token function">removeWorksheet</span><span class="token punctuation">(</span>sheet<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="访问工作表⬆"><a href="#访问工作表⬆" class="header-anchor">#</a> 访问工作表<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 遍历所有工作表</span>
<span class="token comment">// 注意： workbook.worksheets.forEach 仍然是可以正常运行的， 但是以下的方式更好</span>
workbook<span class="token punctuation">.</span><span class="token function">eachSheet</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">worksheet<span class="token punctuation">,</span> sheetId</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 按 name 提取工作表</span>
<span class="token keyword">const</span> worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">getWorksheet</span><span class="token punctuation">(</span><span class="token string">'My Sheet'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 按 id 提取工作表</span>
<span class="token keyword">const</span> worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">getWorksheet</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="工作表状态⬆"><a href="#工作表状态⬆" class="header-anchor">#</a> 工作表状态<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 使工作表可见</span>
worksheet<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'visible'</span><span class="token punctuation">;</span>

<span class="token comment">// 隐藏工作表</span>
worksheet<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'hidden'</span><span class="token punctuation">;</span>

<span class="token comment">// 从“隐藏/取消隐藏”对话框中隐藏工作表</span>
worksheet<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">'veryHidden'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="工作表属性⬆"><a href="#工作表属性⬆" class="header-anchor">#</a> 工作表属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>工作表支持属性存储，以允许控制工作表的某些功能。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 创建具有属性的新工作表</span>
<span class="token keyword">const</span> worksheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'sheet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">properties</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">tabColor</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FF00FF00'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建一个具有属性的可写的新工作表</span>
<span class="token keyword">const</span> worksheetWriter <span class="token operator">=</span> workbookWriter<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'sheet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">properties</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">outlineLevelCol</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 之后调整属性（工作表读写器不支持该操作）</span>
worksheet<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>outlineLevelCol <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>defaultRowHeight <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>支持的属性</strong></p> <table><thead><tr><th>属性名</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>tabColor</td> <td><code>undefined</code></td> <td>标签的颜色</td></tr> <tr><td>outlineLevelCol</td> <td>0</td> <td>工作表列大纲级别</td></tr> <tr><td>outlineLevelRow</td> <td>0</td> <td>工作表行大纲级别</td></tr> <tr><td>defaultRowHeight</td> <td>15</td> <td>默认行高</td></tr> <tr><td>defaultColWidth</td> <td>(optional)</td> <td>默认列宽</td></tr> <tr><td>dyDescent</td> <td>55</td> <td>TBD</td></tr></tbody></table> <h3 id="工作表尺寸⬆"><a href="#工作表尺寸⬆" class="header-anchor">#</a> 工作表尺寸<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>一些新的尺寸属性已添加到工作表中...</p> <table><thead><tr><th>属性名</th> <th>描述</th></tr></thead> <tbody><tr><td>rowCount</td> <td>文档的总行数。 等于具有值的最后一行的行号。</td></tr> <tr><td>actualRowCount</td> <td>具有值的行数的计数。 如果中间文档行为空，则该行将不包括在计数中。</td></tr> <tr><td>columnCount</td> <td>文档的总列数。 等于所有行的最大单元数。</td></tr> <tr><td>actualColumnCount</td> <td>具有值的列数的计数。</td></tr></tbody></table> <h2 id="页面设置⬆"><a href="#页面设置⬆" class="header-anchor">#</a> 页面设置<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>所有可能影响工作表打印的属性都保存在工作表上的 <code>pageSetup</code> 对象中。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 使用 A4 横向的页面设置创建新工作表</span>
<span class="token keyword">const</span> worksheet <span class="token operator">=</span>  workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'sheet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">pageSetup</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">paperSize</span><span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span> <span class="token literal-property property">orientation</span><span class="token operator">:</span><span class="token string">'landscape'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用适合页面的pageSetup设置创建一个新的工作表编写器</span>
<span class="token keyword">const</span> worksheetWriter <span class="token operator">=</span> workbookWriter<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'sheet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">pageSetup</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">fitToPage</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">fitToHeight</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token literal-property property">fitToWidth</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 之后调整页面设置配置</span>
worksheet<span class="token punctuation">.</span>pageSetup<span class="token punctuation">.</span>margins <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token number">0.7</span><span class="token punctuation">,</span> <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token number">0.7</span><span class="token punctuation">,</span>
  <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token number">0.75</span><span class="token punctuation">,</span> <span class="token literal-property property">bottom</span><span class="token operator">:</span> <span class="token number">0.75</span><span class="token punctuation">,</span>
  <span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token number">0.3</span><span class="token punctuation">,</span> <span class="token literal-property property">footer</span><span class="token operator">:</span> <span class="token number">0.3</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 设置工作表的打印区域</span>
worksheet<span class="token punctuation">.</span>pageSetup<span class="token punctuation">.</span>printArea <span class="token operator">=</span> <span class="token string">'A1:G20'</span><span class="token punctuation">;</span>

<span class="token comment">// 通过使用 `&amp;&amp;` 分隔打印区域来设置多个打印区域</span>
worksheet<span class="token punctuation">.</span>pageSetup<span class="token punctuation">.</span>printArea <span class="token operator">=</span> <span class="token string">'A1:G10&amp;&amp;A11:G20'</span><span class="token punctuation">;</span>

<span class="token comment">// 在每个打印页面上重复特定的行</span>
worksheet<span class="token punctuation">.</span>pageSetup<span class="token punctuation">.</span>printTitlesRow <span class="token operator">=</span> <span class="token string">'1:3'</span><span class="token punctuation">;</span>

<span class="token comment">// 在每个打印页面上重复特定列</span>
worksheet<span class="token punctuation">.</span>pageSetup<span class="token punctuation">.</span>printTitlesColumn <span class="token operator">=</span> <span class="token string">'A:C'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><p><strong>支持的页面设置配置项</strong></p> <table><thead><tr><th>属性名</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>margins</td> <td></td> <td>页面上的空白边距。 单位为英寸。</td></tr> <tr><td>orientation</td> <td><code>'portrait'</code></td> <td>页面方向 - 即较高 (<code>'portrait'</code>) 或者较宽 (<code>'landscape'</code>)</td></tr> <tr><td>horizontalDpi</td> <td>4294967295</td> <td>水平方向上的 DPI。默认值为 <code>-1</code></td></tr> <tr><td>verticalDpi</td> <td>4294967295</td> <td>垂直方向上的 DPI。默认值为 <code>-1</code></td></tr> <tr><td>fitToPage</td> <td></td> <td>是否使用 <code>fitToWidth</code> 和 <code>fitToHeight</code> 或 <code>scale</code> 设置。默认基于存在于 <code>pageSetup</code> 对象中的设置-如果两者都存在，则 <code>scale</code> 优先级高（默认值为 <code>false</code>）。</td></tr> <tr><td>pageOrder</td> <td><code>'downThenOver'</code></td> <td>打印页面的顺序-<code>['downThenOver', 'overThenDown']</code> 之一</td></tr> <tr><td>blackAndWhite</td> <td><code>false</code></td> <td>无色打印</td></tr> <tr><td>draft</td> <td><code>false</code></td> <td>打印质量较低（墨水）</td></tr> <tr><td>cellComments</td> <td><code>'None'</code></td> <td>在何处放置批注-<code>['atEnd'，'asDisplayed'，'None']</code>中的一个</td></tr> <tr><td>errors</td> <td><code>'displayed'</code></td> <td>哪里显示错误 -<code>['dash', 'blank', 'NA', 'displayed']</code> 之一</td></tr> <tr><td>scale</td> <td>100</td> <td>增加或减小打印尺寸的百分比值。 当 <code>fitToPage</code> 为 <code>false</code> 时激活</td></tr> <tr><td>fitToWidth</td> <td>1</td> <td>纸张应打印多少页宽。 当 <code>fitToPage</code> 为 <code>true</code> 时激活</td></tr> <tr><td>fitToHeight</td> <td>1</td> <td>纸张应打印多少页高。 当 <code>fitToPage</code> 为 <code>true</code> 时激活</td></tr> <tr><td>paperSize</td> <td></td> <td>使用哪种纸张尺寸（见下文）</td></tr> <tr><td>showRowColHeaders</td> <td>false</td> <td>是否显示行号和列字母</td></tr> <tr><td>showGridLines</td> <td>false</td> <td>是否显示网格线</td></tr> <tr><td>firstPageNumber</td> <td></td> <td>第一页使用哪个页码</td></tr> <tr><td>horizontalCentered</td> <td>false</td> <td>是否将工作表数据水平居中</td></tr> <tr><td>verticalCentered</td> <td>false</td> <td>是否将工作表数据垂直居中</td></tr></tbody></table> <p><strong>示例纸张尺寸</strong></p> <table><thead><tr><th>属性名</th> <th>值</th></tr></thead> <tbody><tr><td>Letter</td> <td><code>undefined</code></td></tr> <tr><td>Legal</td> <td>5</td></tr> <tr><td>Executive</td> <td>7</td></tr> <tr><td>A3</td> <td>8</td></tr> <tr><td>A4</td> <td>9</td></tr> <tr><td>A5</td> <td>11</td></tr> <tr><td>B5 (JIS)</td> <td>13</td></tr> <tr><td>Envelope #10</td> <td>20</td></tr> <tr><td>Envelope DL</td> <td>27</td></tr> <tr><td>Envelope C5</td> <td>28</td></tr> <tr><td>Envelope B5</td> <td>34</td></tr> <tr><td>Envelope Monarch</td> <td>37</td></tr> <tr><td>Double Japan Postcard Rotated</td> <td>82</td></tr> <tr><td>16K 197x273 mm</td> <td>119</td></tr></tbody></table> <h2 id="页眉和页脚⬆"><a href="#页眉和页脚⬆" class="header-anchor">#</a> 页眉和页脚<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>这是添加页眉和页脚的方法。
添加的内容主要是文本，例如时间，简介，文件信息等，您可以设置文本的样式。
此外，您可以为首页和偶数页设置不同的文本。</p> <p>注意：目前不支持图片。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 创建一个带有页眉和页脚的工作表</span>
<span class="token keyword">var</span> sheet <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'My Sheet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">headerFooter</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">firstHeader</span><span class="token operator">:</span> <span class="token string">&quot;Hello Exceljs&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">firstFooter</span><span class="token operator">:</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 创建一个带有页眉和页脚可写的工作表</span>
<span class="token keyword">var</span> worksheetWriter <span class="token operator">=</span> workbookWriter<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'sheet'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">headerFooter</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">firstHeader</span><span class="token operator">:</span> <span class="token string">&quot;Hello Exceljs&quot;</span><span class="token punctuation">,</span> <span class="token literal-property property">firstFooter</span><span class="token operator">:</span> <span class="token string">&quot;Hello World&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 代码中出现的&amp;开头字符对应变量，相关信息可查阅下文的变量表</span>
<span class="token comment">// 设置页脚(默认居中),结果：“第 2 页，共 16 页”</span>
worksheet<span class="token punctuation">.</span>headerFooter<span class="token punctuation">.</span>oddFooter <span class="token operator">=</span> <span class="token string">&quot;第 &amp;P 页，共 &amp;N 页&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 将页脚（默认居中）设置为粗体，结果是：“第2页，共16页”</span>
worksheet<span class="token punctuation">.</span>headerFooter<span class="token punctuation">.</span>oddFooter <span class="token operator">=</span> <span class="token string">&quot;Page &amp;P of &amp;N&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 将左页脚设置为 18px 并以斜体显示。 结果：“第2页，共16页”</span>
worksheet<span class="token punctuation">.</span>headerFooter<span class="token punctuation">.</span>oddFooter <span class="token operator">=</span> <span class="token string">&quot;&amp;LPage &amp;P of &amp;N&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 将中间标题设置为灰色Aril，结果为：“ 52 exceljs”</span>
worksheet<span class="token punctuation">.</span>headerFooter<span class="token punctuation">.</span>oddHeader <span class="token operator">=</span> <span class="token string">&quot;&amp;C&amp;KCCCCCC&amp;\&quot;Aril\&quot;52 exceljs&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 设置页脚的左，中和右文本。 结果：页脚左侧为“ Exceljs”。 页脚中心的“ demo.xlsx”。 页脚右侧的“第2页”</span>
worksheet<span class="token punctuation">.</span>headerFooter<span class="token punctuation">.</span>oddFooter <span class="token operator">=</span> <span class="token string">&quot;&amp;Lexceljs&amp;C&amp;F&amp;RPage &amp;P&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 在首页添加不同的页眉和页脚</span>
worksheet<span class="token punctuation">.</span>headerFooter<span class="token punctuation">.</span>differentFirst <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span>headerFooter<span class="token punctuation">.</span>firstHeader <span class="token operator">=</span> <span class="token string">&quot;Hello Exceljs&quot;</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span>headerFooter<span class="token punctuation">.</span>firstFooter <span class="token operator">=</span> <span class="token string">&quot;Hello World&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br></div></div><p><strong>支持的 headerFooter 设置</strong></p> <table><thead><tr><th>属性名</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>differentFirst</td> <td><code>false</code></td> <td>将 <code>differentFirst</code> 的值设置为 <code>true</code>，这表示第一页的页眉/页脚与其他页不同</td></tr> <tr><td>differentOddEven</td> <td><code>false</code></td> <td>将 <code>differentOddEven</code> 的值设置为 <code>true</code>，表示奇数页和偶数页的页眉/页脚不同</td></tr> <tr><td>oddHeader</td> <td><code>null</code></td> <td>设置奇数（默认）页面的标题字符串，可以设置格式化字符串</td></tr> <tr><td>oddFooter</td> <td><code>null</code></td> <td>设置奇数（默认）页面的页脚字符串，可以设置格式化字符串</td></tr> <tr><td>evenHeader</td> <td><code>null</code></td> <td>设置偶数页的标题字符串，可以设置格式化字符串</td></tr> <tr><td>evenFooter</td> <td><code>null</code></td> <td>为偶数页设置页脚字符串，可以设置格式化字符串</td></tr> <tr><td>firstHeader</td> <td><code>null</code></td> <td>设置首页的标题字符串，可以设置格式化字符串</td></tr> <tr><td>firstFooter</td> <td><code>null</code></td> <td>设置首页的页脚字符串，可以设置格式化字符串</td></tr></tbody></table> <p><strong>脚本命令</strong></p> <table><thead><tr><th>命令</th> <th>描述</th></tr></thead> <tbody><tr><td>&amp;L</td> <td>将位置设定在左侧</td></tr> <tr><td>&amp;C</td> <td>将位置设置在中心</td></tr> <tr><td>&amp;R</td> <td>将位置设定在右边</td></tr> <tr><td>&amp;P</td> <td>当前页码</td></tr> <tr><td>&amp;N</td> <td>总页数</td></tr> <tr><td>&amp;D</td> <td>当前日期</td></tr> <tr><td>&amp;T</td> <td>当前时间</td></tr> <tr><td>&amp;G</td> <td>照片</td></tr> <tr><td>&amp;A</td> <td>工作表名称</td></tr> <tr><td>&amp;F</td> <td>文件名称</td></tr> <tr><td>&amp;B</td> <td>加粗文本</td></tr> <tr><td>&amp;I</td> <td>斜体文本</td></tr> <tr><td>&amp;U</td> <td>文本下划线</td></tr> <tr><td>&amp;&quot;font name&quot;</td> <td>字体名称，例如＆“ Aril”</td></tr> <tr><td>&amp;font size</td> <td>字体大小，例如12</td></tr> <tr><td>&amp;KHEXCode</td> <td>字体颜色，例如 &amp;KCCCCCC</td></tr></tbody></table> <h2 id="工作表视图⬆"><a href="#工作表视图⬆" class="header-anchor">#</a> 工作表视图<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>现在，工作表支持视图列表，这些视图控制Excel如何显示工作表：</p> <ul><li><code>frozen</code> - 顶部和左侧的许多行和列被冻结在适当的位置。 仅右下部分会滚动</li> <li><code>split</code> - 该视图分为4个部分，每个部分可半独立滚动。</li></ul> <p>每个视图还支持各种属性：</p> <table><thead><tr><th>属性名</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>state</td> <td><code>'normal'</code></td> <td>控制视图状态 -  <code>'normal'</code>, <code>'frozen'</code> 或者 <code>'split'</code> 之一</td></tr> <tr><td>rightToLeft</td> <td><code>false</code></td> <td>将工作表视图的方向设置为从右到左</td></tr> <tr><td>activeCell</td> <td><code>undefined</code></td> <td>当前选择的单元格</td></tr> <tr><td>showRuler</td> <td><code>true</code></td> <td>在页面布局中显示或隐藏标尺</td></tr> <tr><td>showRowColHeaders</td> <td><code>true</code></td> <td>显示或隐藏行标题和列标题（例如，顶部的 A1，B1 和左侧的1,2,3）</td></tr> <tr><td>showGridLines</td> <td><code>true</code></td> <td>显示或隐藏网格线（针对未定义边框的单元格显示）</td></tr> <tr><td>zoomScale</td> <td>100</td> <td>用于视图的缩放比例</td></tr> <tr><td>zoomScaleNormal</td> <td>100</td> <td>正常缩放视图</td></tr> <tr><td>style</td> <td><code>undefined</code></td> <td>演示样式- <code>pageBreakPreview</code> 或 <code>pageLayout</code> 之一。 注意：页面布局与 <code>frozen</code> 视图不兼容</td></tr></tbody></table> <h3 id="冻结视图⬆"><a href="#冻结视图⬆" class="header-anchor">#</a> 冻结视图<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>冻结视图支持以下额外属性：</p> <table><thead><tr><th>属性名</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>xSplit</td> <td>0</td> <td>冻结多少列。要仅冻结行，请将其设置为 <code>0</code> 或 <code>undefined</code></td></tr> <tr><td>ySplit</td> <td>0</td> <td>冻结多少行。要仅冻结列，请将其设置为 <code>0</code> 或 <code>undefined</code></td></tr> <tr><td>topLeftCell</td> <td>special</td> <td>哪个单元格将在右下窗格中的左上角。注意：不能是冻结单元格。默认为第一个未冻结的单元格</td></tr></tbody></table> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span>views <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span><span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token string">'frozen'</span><span class="token punctuation">,</span> <span class="token literal-property property">xSplit</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">ySplit</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token literal-property property">topLeftCell</span><span class="token operator">:</span> <span class="token string">'G10'</span><span class="token punctuation">,</span> <span class="token literal-property property">activeCell</span><span class="token operator">:</span> <span class="token string">'A1'</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="拆分视图⬆"><a href="#拆分视图⬆" class="header-anchor">#</a> 拆分视图<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>拆分视图支持以下额外属性：</p> <table><thead><tr><th>属性名</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>xSplit</td> <td>0</td> <td>从左侧多少个点起，以放置拆分器。要垂直拆分，请将其设置为 <code>0</code> 或 <code>undefined</code></td></tr> <tr><td>ySplit</td> <td>0</td> <td>从顶部多少个点起，放置拆分器。要水平拆分，请将其设置为 <code>0</code> 或 <code>undefined</code></td></tr> <tr><td>topLeftCell</td> <td><code>undefined</code></td> <td>哪个单元格将在右下窗格中的左上角。</td></tr> <tr><td>activePane</td> <td><code>undefined</code></td> <td>哪个窗格将处于活动状态-<code>topLeft</code>，<code>topRight</code>，<code>bottomLeft</code> 和 <code>bottomRight</code> 中的一个</td></tr></tbody></table> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span>views <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span><span class="token literal-property property">state</span><span class="token operator">:</span> <span class="token string">'split'</span><span class="token punctuation">,</span> <span class="token literal-property property">xSplit</span><span class="token operator">:</span> <span class="token number">2000</span><span class="token punctuation">,</span> <span class="token literal-property property">ySplit</span><span class="token operator">:</span> <span class="token number">3000</span><span class="token punctuation">,</span> <span class="token literal-property property">topLeftCell</span><span class="token operator">:</span> <span class="token string">'G10'</span><span class="token punctuation">,</span> <span class="token literal-property property">activeCell</span><span class="token operator">:</span> <span class="token string">'A1'</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="自动筛选器⬆"><a href="#自动筛选器⬆" class="header-anchor">#</a> 自动筛选器<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>可以对工作表应用自动筛选器。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span>autoFilter <span class="token operator">=</span> <span class="token string">'A1:C1'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>尽管范围字符串是 <code>autoFilter</code> 的标准形式，但工作表还将支持以下值：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 将自动筛选器设置为从 A1 到 C1</span>
worksheet<span class="token punctuation">.</span>autoFilter <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">'A1'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token string">'C1'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>

<span class="token comment">// 将自动筛选器设置为从第3行第1列的单元格到第5行第12列的单元格</span>
worksheet<span class="token punctuation">.</span>autoFilter <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
    <span class="token literal-property property">column</span><span class="token operator">:</span> <span class="token number">1</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span>
    <span class="token literal-property property">column</span><span class="token operator">:</span> <span class="token number">12</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 将自动筛选器设置为从D3到第7行第5列中的单元格</span>
worksheet<span class="token punctuation">.</span>autoFilter <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">from</span><span class="token operator">:</span> <span class="token string">'D3'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">to</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token number">7</span><span class="token punctuation">,</span>
    <span class="token literal-property property">column</span><span class="token operator">:</span> <span class="token number">5</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><h2 id="列⬆"><a href="#列⬆" class="header-anchor">#</a> 列<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 添加列标题并定义列键和宽度</span>
<span class="token comment">// 注意：这些列结构仅是构建工作簿的方便之处，除了列宽之外，它们不会完全保留。</span>
worksheet<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">'Id'</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">32</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">'D.O.B.'</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'DOB'</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token literal-property property">outlineLevel</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 通过键，字母和基于1的列号访问单个列</span>
<span class="token keyword">const</span> idCol <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token string">'id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> nameCol <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token string">'B'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> dobCol <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 设置列属性</span>

<span class="token comment">// 注意：将覆盖 C1 单元格值</span>
dobCol<span class="token punctuation">.</span>header <span class="token operator">=</span> <span class="token string">'Date of Birth'</span><span class="token punctuation">;</span>

<span class="token comment">// 注意：这将覆盖 C1:C2 单元格值</span>
dobCol<span class="token punctuation">.</span>header <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Date of Birth'</span><span class="token punctuation">,</span> <span class="token string">'A.K.A. D.O.B.'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 从现在开始，此列将以 “dob” 而不是 “DOB” 建立索引</span>
dobCol<span class="token punctuation">.</span>key <span class="token operator">=</span> <span class="token string">'dob'</span><span class="token punctuation">;</span>

dobCol<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">15</span><span class="token punctuation">;</span>

<span class="token comment">// 如果需要，隐藏列</span>
dobCol<span class="token punctuation">.</span>hidden <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token comment">// 为列设置大纲级别</span>
worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>outlineLevel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>outlineLevel <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">// 列支持一个只读字段，以指示基于 `OutlineLevel` 的折叠状态</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>collapsed<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>collapsed<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 遍历此列中的所有当前单元格</span>
dobCol<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">cell<span class="token punctuation">,</span> rowNumber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 遍历此列中的所有当前单元格，包括空单元格</span>
dobCol<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">includeEmpty</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">cell<span class="token punctuation">,</span> rowNumber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 添加一列新值</span>
worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 添加稀疏列值</span>
worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 剪切一列或多列（右边的列向左移动）</span>
<span class="token comment">// 如果定义了列属性，则会相应地对其进行切割或移动</span>
<span class="token comment">// 已知问题：如果拼接导致任何合并的单元格移动，结果可能是不可预测的</span>
worksheet<span class="token punctuation">.</span><span class="token function">spliceColumns</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 删除一列，再插入两列。</span>
<span class="token comment">// 注意：第4列及以上的列将右移1列。</span>
<span class="token comment">// 另外：如果工作表中的行数多于列插入项中的值，则行将仍然被插入，就好像值存在一样。</span>
<span class="token keyword">const</span> newCol3Values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newCol4Values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token string">'four'</span><span class="token punctuation">,</span> <span class="token string">'five'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">spliceColumns</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> newCol3Values<span class="token punctuation">,</span> newCol4Values<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div><h2 id="行⬆"><a href="#行⬆" class="header-anchor">#</a> 行<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 获取一个行对象。如果尚不存在，则将返回一个新的空对象</span>
<span class="token keyword">const</span> row <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Get multiple row objects. If it doesn't already exist, new empty ones will be returned</span>
<span class="token keyword">const</span> rows <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">getRows</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// start, length (&gt;0, else undefined is returned)</span>

<span class="token comment">// 获取工作表中的最后一个可编辑行（如果没有，则为 `undefined`）</span>
<span class="token keyword">const</span> row <span class="token operator">=</span> worksheet<span class="token punctuation">.</span>lastRow<span class="token punctuation">;</span>

<span class="token comment">// 设置特定的行高</span>
row<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">42.5</span><span class="token punctuation">;</span>

<span class="token comment">// 隐藏行</span>
row<span class="token punctuation">.</span>hidden <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token comment">// 为行设置大纲级别</span>
worksheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>outlineLevel <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>outlineLevel <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">// 行支持一个只读字段，以指示基于 `OutlineLevel` 的折叠状态</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>collapsed<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>collapsed<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span> <span class="token comment">// A5 的值设置为5</span>
row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'name'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'Zeb'</span><span class="token punctuation">;</span> <span class="token comment">// B5 的值设置为 “Zeb” - 假设第2列仍按名称键入</span>
row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'C'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// C5 的值设置为当前时间</span>

<span class="token comment">// 获取行并作为稀疏数组返回</span>
<span class="token comment">// 注意：接口更改：worksheet.getRow(4) ==&gt; worksheet.getRow(4).values</span>
row <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">.</span>values<span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>row<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token string">'Kyle'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 通过连续数组分配行值（其中数组元素 0 具有值）</span>
row<span class="token punctuation">.</span>values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 通过稀疏数组分配行值（其中数组元素 0 为 `undefined`）</span>
<span class="token keyword">const</span> values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
values<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">7</span><span class="token punctuation">;</span>
values<span class="token punctuation">[</span><span class="token number">10</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Hello, World!'</span><span class="token punctuation">;</span>
row<span class="token punctuation">.</span>values <span class="token operator">=</span> values<span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token string">'Hello, World!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用列键按对象分配行值</span>
row<span class="token punctuation">.</span>values <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">13</span><span class="token punctuation">,</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Thing 1'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dob</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 在该行下方插入一个分页符</span>
row<span class="token punctuation">.</span><span class="token function">addPageBreak</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 遍历工作表中具有值的所有行</span>
worksheet<span class="token punctuation">.</span><span class="token function">eachRow</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">row<span class="token punctuation">,</span> rowNumber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Row '</span> <span class="token operator">+</span> rowNumber <span class="token operator">+</span> <span class="token string">' = '</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 遍历工作表中的所有行（包括空行）</span>
worksheet<span class="token punctuation">.</span><span class="token function">eachRow</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">includeEmpty</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">row<span class="token punctuation">,</span> rowNumber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Row '</span> <span class="token operator">+</span> rowNumber <span class="token operator">+</span> <span class="token string">' = '</span> <span class="token operator">+</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>row<span class="token punctuation">.</span>values<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 连续遍历所有非空单元格</span>
row<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">cell<span class="token punctuation">,</span> colNumber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Cell '</span> <span class="token operator">+</span> colNumber <span class="token operator">+</span> <span class="token string">' = '</span> <span class="token operator">+</span> cell<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 遍历一行中的所有单元格（包括空单元格）</span>
row<span class="token punctuation">.</span><span class="token function">eachCell</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">includeEmpty</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">cell<span class="token punctuation">,</span> colNumber</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Cell '</span> <span class="token operator">+</span> colNumber <span class="token operator">+</span> <span class="token string">' = '</span> <span class="token operator">+</span> cell<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 提交给流一个完成的行</span>
row<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 行尺寸</span>
<span class="token keyword">const</span> rowSize <span class="token operator">=</span> row<span class="token punctuation">.</span>cellCount<span class="token punctuation">;</span>
<span class="token keyword">const</span> numValues <span class="token operator">=</span> row<span class="token punctuation">.</span>actualCellCount<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br></div></div><h2 id="add-rows⬆"><a href="#add-rows⬆" class="header-anchor">#</a> Add Rows<a href="#contents">⬆</a></h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Add a couple of Rows by key-value, after the last current row, using the column keys</span>
worksheet<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'John Doe'</span><span class="token punctuation">,</span> <span class="token literal-property property">dob</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">1970</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Jane Doe'</span><span class="token punctuation">,</span> <span class="token literal-property property">dob</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">1965</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add a row by contiguous Array (assign to columns A, B &amp; C)</span>
worksheet<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Sam'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add a row by sparse Array (assign to columns A, E &amp; I)</span>
<span class="token keyword">const</span> rowValues <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
rowValues<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
rowValues<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Kyle'</span><span class="token punctuation">;</span>
rowValues<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>rowValues<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add a row with inherited style</span>
<span class="token comment">// This new row will have same style as last row</span>
<span class="token comment">// And return as row object</span>
<span class="token keyword">const</span> newRow <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span>rowValues<span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add an array of rows</span>
<span class="token keyword">const</span> rows <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'Bob'</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// row by array</span>
  <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Barbara'</span><span class="token punctuation">,</span> <span class="token literal-property property">dob</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// add new rows and return them as array of row objects</span>
<span class="token keyword">const</span> newRows <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">addRows</span><span class="token punctuation">(</span>rows<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Add an array of rows with inherited style</span>
<span class="token comment">// These new rows will have same styles as last row</span>
<span class="token comment">// and return them as array of row objects</span>
<span class="token keyword">const</span> newRowsStyled <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">addRows</span><span class="token punctuation">(</span>rows<span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default Value</th></tr></thead> <tbody><tr><td>value/s</td> <td>The new row/s values</td> <td></td></tr> <tr><td>style</td> <td>'i' for inherit from row above, 'i+' to include empty cells, 'n' for none</td> <td><em>'n'</em></td></tr></tbody></table> <h2 id="处理单个单元格⬆"><a href="#处理单个单元格⬆" class="header-anchor">#</a> 处理单个单元格<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> cell <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'C3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 修改/添加单个单元格</span>
cell<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">1968</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 查询单元格的类型</span>
<span class="token function">expect</span><span class="token punctuation">(</span>cell<span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span>Excel<span class="token punctuation">.</span>ValueType<span class="token punctuation">.</span>Date<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用单元格的字符串值</span>
myInput<span class="token punctuation">.</span>value <span class="token operator">=</span> cell<span class="token punctuation">.</span>text<span class="token punctuation">;</span>

<span class="token comment">// 使用 html 安全的字符串进行渲染...</span>
<span class="token keyword">const</span> html <span class="token operator">=</span> <span class="token string">'&lt;div&gt;'</span> <span class="token operator">+</span> cell<span class="token punctuation">.</span>html <span class="token operator">+</span> <span class="token string">'&lt;/div&gt;'</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="合并单元格⬆"><a href="#合并单元格⬆" class="header-anchor">#</a> 合并单元格<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 合并一系列单元格</span>
worksheet<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token string">'A4:B5'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ...合并的单元格被链接起来了</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'Hello, World!'</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A4'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>master<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A4'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// ...合并的单元格共享相同的样式对象</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A4'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">)</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>font <span class="token operator">=</span> myFonts<span class="token punctuation">.</span>arial<span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A4'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>font<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>myFonts<span class="token punctuation">.</span>arial<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 取消单元格合并将打破链接的样式</span>
worksheet<span class="token punctuation">.</span><span class="token function">unMergeCells</span><span class="token punctuation">(</span><span class="token string">'A4'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">)</span><span class="token punctuation">.</span>not<span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A4'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>style<span class="token punctuation">.</span>font<span class="token punctuation">)</span><span class="token punctuation">.</span>not<span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span>myFonts<span class="token punctuation">.</span>arial<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 按左上，右下合并</span>
worksheet<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token string">'K10'</span><span class="token punctuation">,</span> <span class="token string">'M12'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 按开始行，开始列，结束行，结束列合并（相当于 K10:M12）</span>
worksheet<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span><span class="token punctuation">,</span><span class="token number">12</span><span class="token punctuation">,</span><span class="token number">13</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="insert-rows⬆"><a href="#insert-rows⬆" class="header-anchor">#</a> Insert Rows<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">insertRow</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> value<span class="token punctuation">,</span> style <span class="token operator">=</span> <span class="token string">'n'</span><span class="token punctuation">)</span>
<span class="token function">insertRows</span><span class="token punctuation">(</span>pos<span class="token punctuation">,</span> values<span class="token punctuation">,</span> style <span class="token operator">=</span> <span class="token string">'n'</span><span class="token punctuation">)</span>

<span class="token comment">// Insert a couple of Rows by key-value, shifting down rows every time</span>
worksheet<span class="token punctuation">.</span><span class="token function">insertRow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'John Doe'</span><span class="token punctuation">,</span> <span class="token literal-property property">dob</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">1970</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">insertRow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Jane Doe'</span><span class="token punctuation">,</span> <span class="token literal-property property">dob</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">1965</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Insert a row by contiguous Array (assign to columns A, B &amp; C)</span>
worksheet<span class="token punctuation">.</span><span class="token function">insertRow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'Sam'</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Insert a row by sparse Array (assign to columns A, E &amp; I)</span>
<span class="token keyword">var</span> rowValues <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
rowValues<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">4</span><span class="token punctuation">;</span>
rowValues<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'Kyle'</span><span class="token punctuation">;</span>
rowValues<span class="token punctuation">[</span><span class="token number">9</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// insert new row and return as row object</span>
<span class="token keyword">const</span> insertedRow <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">insertRow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> rowValues<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Insert a row, with inherited style</span>
<span class="token comment">// This new row will have same style as row on top of it</span>
<span class="token comment">// And return as row object</span>
<span class="token keyword">const</span> insertedRowInherited <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">insertRow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> rowValues<span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Insert a row, keeping original style</span>
<span class="token comment">// This new row will have same style as it was previously</span>
<span class="token comment">// And return as row object</span>
<span class="token keyword">const</span> insertedRowOriginal <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">insertRow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> rowValues<span class="token punctuation">,</span> <span class="token string">'o'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Insert an array of rows, in position 1, shifting down current position 1 and later rows by 2 rows</span>
<span class="token keyword">var</span> rows <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token string">'Bob'</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// row by array</span>
  <span class="token punctuation">{</span><span class="token literal-property property">id</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Barbara'</span><span class="token punctuation">,</span> <span class="token literal-property property">dob</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// insert new rows and return them as array of row objects</span>
<span class="token keyword">const</span> insertedRows <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">insertRows</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> rows<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Insert an array of rows, with inherited style</span>
<span class="token comment">// These new rows will have same style as row on top of it</span>
<span class="token comment">// And return them as array of row objects</span>
<span class="token keyword">const</span> insertedRowsInherited <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">insertRows</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> rows<span class="token punctuation">,</span> <span class="token string">'i'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Insert an array of rows, keeping original style</span>
<span class="token comment">// These new rows will have same style as it was previously in 'pos' position</span>
<span class="token keyword">const</span> insertedRowsOriginal <span class="token operator">=</span> worksheet<span class="token punctuation">.</span><span class="token function">insertRows</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> rows<span class="token punctuation">,</span> <span class="token string">'o'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div><table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default Value</th></tr></thead> <tbody><tr><td>pos</td> <td>Row number where you want to insert, pushing down all rows from there</td> <td></td></tr> <tr><td>value/s</td> <td>The new row/s values</td> <td></td></tr> <tr><td>style</td> <td>'i' for inherit from row above, , 'i+' to include empty cells, 'o' for original style, 'o+' to include empty cells, 'n' for none</td> <td><em>'n'</em></td></tr></tbody></table> <h2 id="splice⬆"><a href="#splice⬆" class="header-anchor">#</a> Splice<a href="#contents">⬆</a></h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// Cut one or more rows (rows below are shifted up)</span>
<span class="token comment">// Known Issue: If a splice causes any merged cells to move, the results may be unpredictable</span>
worksheet<span class="token punctuation">.</span><span class="token function">spliceRows</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// remove one row and insert two more.</span>
<span class="token comment">// Note: rows 4 and below will be shifted down by 1 row.</span>
<span class="token keyword">const</span> newRow3Values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> newRow4Values <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'one'</span><span class="token punctuation">,</span> <span class="token string">'two'</span><span class="token punctuation">,</span> <span class="token string">'three'</span><span class="token punctuation">,</span> <span class="token string">'four'</span><span class="token punctuation">,</span> <span class="token string">'five'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">spliceRows</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> newRow3Values<span class="token punctuation">,</span> newRow4Values<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Cut one or more cells (cells to the right are shifted left)</span>
<span class="token comment">// Note: this operation will not affect other rows</span>
row<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// remove one cell and insert two more (cells to the right of the cut cell will be shifted right)</span>
row<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'new value 1'</span><span class="token punctuation">,</span> <span class="token string">'new value 2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><table><thead><tr><th>Parameter</th> <th>Description</th> <th>Default Value</th></tr></thead> <tbody><tr><td>start</td> <td>Starting point to splice from</td> <td></td></tr> <tr><td>count</td> <td>Number of rows/cells to remove</td> <td></td></tr> <tr><td>...inserts</td> <td>New row/cell values to insert</td> <td></td></tr></tbody></table> <h2 id="重复行⬆"><a href="#重复行⬆" class="header-anchor">#</a> 重复行<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">duplicateRow</span><span class="token punctuation">(</span>start<span class="token punctuation">,</span> amount <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> insert <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> wb <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> ws <span class="token operator">=</span> wb<span class="token punctuation">.</span><span class="token function">addWorksheet</span><span class="token punctuation">(</span><span class="token string">'duplicateTest'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'One'</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'Two'</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'Three'</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A4'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'Four'</span><span class="token punctuation">;</span>

<span class="token comment">// 该行将重复复制第一行两次，但将替换第二行和第三行</span>
<span class="token comment">// 如果第三个参数为 true，则它将插入2个新行，其中包含行 “One” 的值和样式</span>
ws<span class="token punctuation">.</span><span class="token function">duplicateRow</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><table><thead><tr><th>参数</th> <th>描述</th> <th>默认值</th></tr></thead> <tbody><tr><td>start</td> <td>要复制的行号（Excel中的第一个是1）</td> <td></td></tr> <tr><td>amount</td> <td>您要复制行的次数</td> <td>1</td></tr> <tr><td>insert</td> <td>如果要为重复项插入新行，则为 <code>true</code>，否则为 <code>false</code> 将替换已有行</td> <td><code>true</code></td></tr></tbody></table> <h2 id="定义名称⬆"><a href="#定义名称⬆" class="header-anchor">#</a> 定义名称<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>单个单元格（或多个单元格组）可以为它们分配名称。名称可用于公式和数据验证（可能还有更多）。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 为单元格分配（或获取）名称（将覆盖该单元具有的其他任何名称）</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'PI'</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token string">'PI'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 为单元格分配（或获取）一组名称（单元可以具有多个名称）</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>names <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'thing1'</span><span class="token punctuation">,</span> <span class="token string">'thing2'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>names<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>have<span class="token punctuation">.</span><span class="token function">members</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'thing1'</span><span class="token punctuation">,</span> <span class="token string">'thing2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 从单元格中删除名称</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeName</span><span class="token punctuation">(</span><span class="token string">'thing1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>names<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>have<span class="token punctuation">.</span><span class="token function">members</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'thing2'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="数据验证⬆"><a href="#数据验证⬆" class="header-anchor">#</a> 数据验证<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>单元格可以定义哪些值有效或无效，并提示用户以帮助指导它们。</p> <p>验证类型可以是以下之一：</p> <table><thead><tr><th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>list</td> <td>定义一组离散的有效值。Excel 将在下拉菜单中提供这些内容，以便于输入</td></tr> <tr><td>whole</td> <td>该值必须是整数</td></tr> <tr><td>decimal</td> <td>该值必须是十进制数</td></tr> <tr><td>textLength</td> <td>该值可以是文本，但长度是受控的</td></tr> <tr><td>custom</td> <td>自定义公式控制有效值</td></tr></tbody></table> <p>对于 <code>list</code> 或 <code>custom</code> 以外的其他类型，以下运算符会影响验证：</p> <table><thead><tr><th>运算符</th> <th>描述</th></tr></thead> <tbody><tr><td>between</td> <td>值必须介于公式结果之间</td></tr> <tr><td>notBetween</td> <td>值不能介于公式结果之间</td></tr> <tr><td>equal</td> <td>值必须等于公式结果</td></tr> <tr><td>notEqual</td> <td>值不能等于公式结果</td></tr> <tr><td>greaterThan</td> <td>值必须大于公式结果</td></tr> <tr><td>lessThan</td> <td>值必须小于公式结果</td></tr> <tr><td>greaterThanOrEqual</td> <td>值必须大于或等于公式结果</td></tr> <tr><td>lessThanOrEqual</td> <td>值必须小于或等于公式结果</td></tr></tbody></table> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 指定有效值的列表（One，Two，Three，Four）。</span>
<span class="token comment">// Excel 将提供一个包含这些值的下拉列表。</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dataValidation <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">allowBlank</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">formulae</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'&quot;One,Two,Three,Four&quot;'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 指定范围内的有效值列表。</span>
<span class="token comment">// Excel 将提供一个包含这些值的下拉列表。</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dataValidation <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'list'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">allowBlank</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">formulae</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'$D$5:$F$5'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 指定单元格必须为非5的整数。</span>
<span class="token comment">// 向用户显示适当的错误消息（如果他们弄错了）</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dataValidation <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'whole'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">operator</span><span class="token operator">:</span> <span class="token string">'notEqual'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">showErrorMessage</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">formulae</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">errorStyle</span><span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">errorTitle</span><span class="token operator">:</span> <span class="token string">'Five'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">'The value must not be Five'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 指定单元格必须为1.5到7之间的十进制数字。</span>
<span class="token comment">// 添加“工具提示”以帮助指导用户</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dataValidation <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'decimal'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">operator</span><span class="token operator">:</span> <span class="token string">'between'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">allowBlank</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">showInputMessage</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">formulae</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">promptTitle</span><span class="token operator">:</span> <span class="token string">'Decimal'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">prompt</span><span class="token operator">:</span> <span class="token string">'The value must between 1.5 and 7'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 指定单元格的文本长度必须小于15</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dataValidation <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'textLength'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">operator</span><span class="token operator">:</span> <span class="token string">'lessThan'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">showErrorMessage</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">allowBlank</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">formulae</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">15</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 指定单元格必须是2016年1月1日之前的日期</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dataValidation <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'date'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">operator</span><span class="token operator">:</span> <span class="token string">'lessThan'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">showErrorMessage</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">allowBlank</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">formulae</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">2016</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br></div></div><h2 id="单元格注释⬆"><a href="#单元格注释⬆" class="header-anchor">#</a> 单元格注释<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>将旧样式的注释添加到单元格</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 纯文字笔记</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>note <span class="token operator">=</span> <span class="token string">'Hello, ExcelJS!'</span><span class="token punctuation">;</span>

<span class="token comment">// 彩色格式化的笔记</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>note <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">texts</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'theme'</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span> <span class="token string-property property">'family'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">'This is '</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'italic'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'theme'</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span> <span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'theme'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span> <span class="token string-property property">'family'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">' '</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'argb'</span><span class="token operator">:</span> <span class="token string">'FFFF6600'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span> <span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">'colorful'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'theme'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span> <span class="token string-property property">'family'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">' text '</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'argb'</span><span class="token operator">:</span> <span class="token string">'FFCCFFCC'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span> <span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">'with'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'theme'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span> <span class="token string-property property">'family'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">' in-cell '</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'bold'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'theme'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span> <span class="token string-property property">'family'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">'format'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">margins</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">insetmode</span><span class="token operator">:</span> <span class="token string">'custom'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">inset</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.35</span><span class="token punctuation">,</span> <span class="token number">0.35</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">protection</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">locked</span><span class="token operator">:</span> True<span class="token punctuation">,</span>
    <span class="token literal-property property">lockText</span><span class="token operator">:</span> False
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">editAs</span><span class="token operator">:</span> <span class="token string">'twoCells'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h3 id="单元格批注属性⬆"><a href="#单元格批注属性⬆" class="header-anchor">#</a> 单元格批注属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>下表定义了单元格注释已支持的属性。</p> <table><thead><tr><th>Field</th> <th>Required</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>texts</td> <td>Y</td> <td></td> <td>评论文字</td></tr> <tr><td>margins</td> <td>N</td> <td>{}</td> <td>确定自动或自定义设置单元格注释的边距值</td></tr> <tr><td>protection</td> <td>N</td> <td>{}</td> <td>可以使用保护属性来指定对象和对象文本的锁定状态</td></tr> <tr><td>editAs</td> <td>N</td> <td>'absolute'</td> <td>可以使用'editAs'属性来指定注释如何锚定到单元格</td></tr></tbody></table> <h3 id="单元格批注页边距⬆"><a href="#单元格批注页边距⬆" class="header-anchor">#</a> 单元格批注页边距<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>确定单元格批注的页面距设置模式，自动或者自定义模式。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>note<span class="token punctuation">.</span>margins <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">insetmode</span><span class="token operator">:</span> <span class="token string">'custom'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">inset</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.25</span><span class="token punctuation">,</span> <span class="token number">0.35</span><span class="token punctuation">,</span> <span class="token number">0.35</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="已支持的页边距属性⬆"><a href="#已支持的页边距属性⬆" class="header-anchor">#</a> 已支持的页边距属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <table><thead><tr><th>Property</th> <th>Required</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>insetmode</td> <td>N</td> <td>'auto'</td> <td>确定是否自动设置注释边距，并且值是'auto' 或者 'custom'</td></tr> <tr><td>inset</td> <td>N</td> <td>[0.13, 0.13, 0.25, 0.25]</td> <td>批注页边距的值，单位是厘米, 方向是左-上-右-下</td></tr></tbody></table> <p>注意：只有当 <code>insetmode</code>的值设置为'custom'时，<code>inset</code>的设置才生效。</p> <h3 id="单元格批注保护⬆"><a href="#单元格批注保护⬆" class="header-anchor">#</a> 单元格批注保护<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>可以使用保护属性来修改单元级别保护。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>note<span class="token punctuation">.</span>protection <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">locked</span><span class="token operator">:</span> <span class="token string">'False'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">lockText</span><span class="token operator">:</span> <span class="token string">'False'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="已支持的保护属性⬆"><a href="#已支持的保护属性⬆" class="header-anchor">#</a> 已支持的保护属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <table><thead><tr><th>Property</th> <th>Required</th> <th>Default Value</th> <th>Description</th></tr></thead> <tbody><tr><td>locked</td> <td>N</td> <td>'True'</td> <td>此元素指定在保护工作表时对象已锁定</td></tr> <tr><td>lockText</td> <td>N</td> <td>'True'</td> <td>该元素指定对象的文本已锁定</td></tr></tbody></table> <h3 id="单元格批注对象位置属性⬆"><a href="#单元格批注对象位置属性⬆" class="header-anchor">#</a> 单元格批注对象位置属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>单元格注释还可以具有属性 'editAs'，该属性将控制注释如何锚定到单元格。
它可以具有以下值之一：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>note<span class="token punctuation">.</span>editAs <span class="token operator">=</span> <span class="token string">'twoCells'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><table><thead><tr><th>Value</th> <th>Description</th></tr></thead> <tbody><tr><td>twoCells</td> <td>它指定注释的大小、位置随单元格而变</td></tr> <tr><td>oneCells</td> <td>它指定注释的大小固定，位置随单元格而变</td></tr> <tr><td>absolute</td> <td>这是默认值，它指定注释的大小、位置均固定</td></tr></tbody></table> <h2 id="表格⬆"><a href="#表格⬆" class="header-anchor">#</a> 表格<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>表允许表格内数据的表内操作。</p> <p>要将表添加到工作表，请定义表模型并调用 <code>addTable</code>：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 将表格添加到工作表</span>
ws<span class="token punctuation">.</span><span class="token function">addTable</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'MyTable'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'A1'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">headerRow</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">totalsRow</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">theme</span><span class="token operator">:</span> <span class="token string">'TableStyleDark3'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">showRowStripes</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">columns</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Date'</span><span class="token punctuation">,</span> <span class="token literal-property property">totalsRowLabel</span><span class="token operator">:</span> <span class="token string">'Totals:'</span><span class="token punctuation">,</span> <span class="token literal-property property">filterButton</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Amount'</span><span class="token punctuation">,</span> <span class="token literal-property property">totalsRowFunction</span><span class="token operator">:</span> <span class="token string">'sum'</span><span class="token punctuation">,</span> <span class="token literal-property property">filterButton</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rows</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">'2019-07-20'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">70.10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">'2019-07-21'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">70.60</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">'2019-07-22'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">70.10</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>注意：将表格添加到工作表将通过放置表格的标题和行数据来修改工作表。
结果就是表格覆盖的工作表上的所有数据（包括标题和所有的）都将被覆盖。</p> <h3 id="表格属性⬆"><a href="#表格属性⬆" class="header-anchor">#</a> 表格属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>下表定义了表格支持的属性。</p> <table><thead><tr><th>表属性</th> <th>描述</th> <th>是否需要</th> <th>默认值</th></tr></thead> <tbody><tr><td>name</td> <td>表格名称</td> <td>Y</td> <td></td></tr> <tr><td>displayName</td> <td>表格的显示名称</td> <td>N</td> <td><code>name</code></td></tr> <tr><td>ref</td> <td>表格的左上方单元格</td> <td>Y</td> <td></td></tr> <tr><td>headerRow</td> <td>在表格顶部显示标题</td> <td>N</td> <td>true</td></tr> <tr><td>totalsRow</td> <td>在表格底部显示总计</td> <td>N</td> <td><code>false</code></td></tr> <tr><td>style</td> <td>额外的样式属性</td> <td>N</td> <td>{}</td></tr> <tr><td>columns</td> <td>列定义</td> <td>Y</td> <td></td></tr> <tr><td>rows</td> <td>数据行</td> <td>Y</td> <td></td></tr></tbody></table> <h3 id="表格样式属性⬆"><a href="#表格样式属性⬆" class="header-anchor">#</a> 表格样式属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>下表定义了表格中支持的属性样式属性。</p> <table><thead><tr><th>样式属性</th> <th>描述</th> <th>是否需要</th> <th>默认值</th></tr></thead> <tbody><tr><td>theme</td> <td>桌子的颜色主题</td> <td>N</td> <td><code>'TableStyleMedium2'</code></td></tr> <tr><td>showFirstColumn</td> <td>突出显示第一列（粗体）</td> <td>N</td> <td><code>false</code></td></tr> <tr><td>showLastColumn</td> <td>突出显示最后一列（粗体）</td> <td>N</td> <td><code>false</code></td></tr> <tr><td>showRowStripes</td> <td>用交替的背景色显示行</td> <td>N</td> <td><code>false</code></td></tr> <tr><td>showColumnStripes</td> <td>用交替的背景色显示列</td> <td>N</td> <td><code>false</code></td></tr></tbody></table> <h3 id="表格列属性⬆"><a href="#表格列属性⬆" class="header-anchor">#</a> 表格列属性<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>下表定义了每个表格列中支持的属性。</p> <table><thead><tr><th>列属性</th> <th>描述</th> <th>是否需要</th> <th>默认值</th></tr></thead> <tbody><tr><td>name</td> <td>列名，也用在标题中</td> <td>Y</td> <td></td></tr> <tr><td>filterButton</td> <td>切换标题中的过滤器控件</td> <td>N</td> <td>false</td></tr> <tr><td>totalsRowLabel</td> <td>用于描述统计行的标签（第一列）</td> <td>N</td> <td><code>'Total'</code></td></tr> <tr><td>totalsRowFunction</td> <td>统计函数名称</td> <td>N</td> <td><code>'none'</code></td></tr> <tr><td>totalsRowFormula</td> <td>自定义函数的可选公式</td> <td>N</td> <td></td></tr></tbody></table> <h3 id="统计函数⬆"><a href="#统计函数⬆" class="header-anchor">#</a> 统计函数<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>下表列出了由列定义的 <code>totalsRowFunction</code> 属性的有效值。如果使用 <code>'custom'</code> 以外的任何值，则无需包括关联的公式，因为该公式将被表格插入。</p> <table><thead><tr><th>统计函数</th> <th>描述</th></tr></thead> <tbody><tr><td>none</td> <td>此列没有统计函数</td></tr> <tr><td>average</td> <td>计算列的平均值</td></tr> <tr><td>countNums</td> <td>统计数字条目数</td></tr> <tr><td>count</td> <td>条目数</td></tr> <tr><td>max</td> <td>此列中的最大值</td></tr> <tr><td>min</td> <td>此列中的最小值</td></tr> <tr><td>stdDev</td> <td>该列的标准偏差</td></tr> <tr><td>var</td> <td>此列的方差</td></tr> <tr><td>sum</td> <td>此列的条目总数</td></tr> <tr><td>custom</td> <td>自定义公式。 需要关联的 <code>totalsRowFormula</code> 值。</td></tr></tbody></table> <h3 id="表格样式主题⬆"><a href="#表格样式主题⬆" class="header-anchor">#</a> 表格样式主题<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>有效的主题名称遵循以下模式：</p> <ul><li>&quot;TableStyle[Shade][Number]&quot;</li></ul> <p>Shades（阴影），Number（数字）可以是以下之一：</p> <ul><li>Light, 1-21</li> <li>Medium, 1-28</li> <li>Dark, 1-11</li></ul> <p>对于无主题，请使用值 <code>null</code>。</p> <p>注意：exceljs 尚不支持自定义表格主题。</p> <h3 id="修改表格⬆"><a href="#修改表格⬆" class="header-anchor">#</a> 修改表格<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>表格支持一组操作函数，这些操作函数允许添加或删除数据以及更改某些属性。由于这些操作中的许多操作可能会对工作表产生副作用，因此更改必须在完成后立即提交。</p> <p>表中的所有索引值均基于零，因此第一行号和第一列号为 <code>0</code>。</p> <p><strong>添加或删除标题和统计</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> table <span class="token operator">=</span> ws<span class="token punctuation">.</span><span class="token function">getTable</span><span class="token punctuation">(</span><span class="token string">'MyTable'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 打开标题行</span>
table<span class="token punctuation">.</span>headerRow <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>

<span class="token comment">// 关闭统计行</span>
table<span class="token punctuation">.</span>totalsRow <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token comment">// 将表更改提交到工作表中</span>
table<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>重定位表</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> table <span class="token operator">=</span> ws<span class="token punctuation">.</span><span class="token function">getTable</span><span class="token punctuation">(</span><span class="token string">'MyTable'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 表格左上移至 D4</span>
table<span class="token punctuation">.</span>ref <span class="token operator">=</span> <span class="token string">'D4'</span><span class="token punctuation">;</span>

<span class="token comment">// 将表更改提交到工作表中</span>
table<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>添加和删除行</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> table <span class="token operator">=</span> ws<span class="token punctuation">.</span><span class="token function">getTable</span><span class="token punctuation">(</span><span class="token string">'MyTable'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 删除前两行</span>
table<span class="token punctuation">.</span><span class="token function">removeRows</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 在索引 5 处插入新行</span>
table<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">'2019-08-05'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">'Mid'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 在表格底部追加新行</span>
table<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token string">'2019-08-10'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token string">'End'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 将表更改提交到工作表中</span>
table<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p><strong>添加和删除列</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> table <span class="token operator">=</span> ws<span class="token punctuation">.</span><span class="token function">getTable</span><span class="token punctuation">(</span><span class="token string">'MyTable'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 删除第二列</span>
table<span class="token punctuation">.</span><span class="token function">removeColumns</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 在索引 1 处插入新列（包含数据）</span>
table<span class="token punctuation">.</span><span class="token function">addColumn</span><span class="token punctuation">(</span>
  <span class="token punctuation">{</span><span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Letter'</span><span class="token punctuation">,</span> <span class="token literal-property property">totalsRowFunction</span><span class="token operator">:</span> <span class="token string">'custom'</span><span class="token punctuation">,</span> <span class="token literal-property property">totalsRowFormula</span><span class="token operator">:</span> <span class="token string">'ROW()'</span><span class="token punctuation">,</span> <span class="token literal-property property">totalsRowResult</span><span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token literal-property property">filterButton</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">,</span> <span class="token string">'d'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token number">2</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 将表更改提交到工作表中</span>
table<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>更改列属性</strong></p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> table <span class="token operator">=</span> ws<span class="token punctuation">.</span><span class="token function">getTable</span><span class="token punctuation">(</span><span class="token string">'MyTable'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 获取第二列的列包装器</span>
<span class="token keyword">const</span> column <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 设置一些属性</span>
column<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Code'</span><span class="token punctuation">;</span>
column<span class="token punctuation">.</span>filterButton <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
column<span class="token punctuation">.</span>style <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token literal-property property">font</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">bold</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Comic Sans MS'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
column<span class="token punctuation">.</span>totalsRowLabel <span class="token operator">=</span> <span class="token string">'Totals'</span><span class="token punctuation">;</span>
column<span class="token punctuation">.</span>totalsRowFunction <span class="token operator">=</span> <span class="token string">'custom'</span><span class="token punctuation">;</span>
column<span class="token punctuation">.</span>totalsRowFormula <span class="token operator">=</span> <span class="token string">'ROW()'</span><span class="token punctuation">;</span>
column<span class="token punctuation">.</span>totalsRowResult <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

<span class="token comment">// 将表更改提交到工作表中</span>
table<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="样式⬆"><a href="#样式⬆" class="header-anchor">#</a> 样式<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>单元格，行和列均支持一组丰富的样式和格式，这些样式和格式会影响单元格的显示方式。</p> <p>通过分配以下属性来设置样式：</p> <ul><li><a href="#数字格式">numFmt</a></li> <li><a href="#字体">font</a></li> <li><a href="#对齐">alignment</a></li> <li><a href="#边框">border</a></li> <li><a href="#填充">fill</a></li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 为单元格分配样式</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numFmt <span class="token operator">=</span> <span class="token string">'0.00%'</span><span class="token punctuation">;</span>

<span class="token comment">// 将样式应用于工作表列</span>
ws<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">'Id'</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">32</span><span class="token punctuation">,</span> <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">font</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Arial Black'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">'D.O.B.'</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'DOB'</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">numFmt</span><span class="token operator">:</span> <span class="token string">'dd/mm/yyyy'</span> <span class="token punctuation">}</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>

<span class="token comment">// 将第3列设置为“货币格式”</span>
ws<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numFmt <span class="token operator">=</span> <span class="token string">'&quot;£&quot;#,##0.00;[Red]\-&quot;£&quot;#,##0.00'</span><span class="token punctuation">;</span>

<span class="token comment">// 将第2行设置为 Comic Sans。</span>
ws<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Comic Sans MS'</span><span class="token punctuation">,</span> <span class="token literal-property property">family</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span> <span class="token literal-property property">underline</span><span class="token operator">:</span> <span class="token string">'double'</span><span class="token punctuation">,</span> <span class="token literal-property property">bold</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>将样式应用于行或列时，它将应用于该行或列中所有当前存在的单元格。另外，创建的任何新单元格都将从其所属的行和列继承其初始样式。</p> <p>如果单元格的行和列都定义了特定的样式（例如，字体），则该单元格所在行样式比列样式具有更高优先级。但是，如果行和列定义了不同的样式（例如 <code>column.numFmt</code> 和 <code>row.font</code>），则单元格将继承行的字体和列的 <code>numFmt</code>。</p> <p>注意：以上所有属性（<code>numFmt</code>（字符串）除外）都是 JS 对象结构。如果将同一样式对象分配给多个电子表格实体，则每个实体将共享同一样式对象。如果样式对象后来在电子表格序列化之前被修改，则所有引用该样式对象的实体也将被修改。此行为旨在通过减少创建的JS对象的数量来优先考虑性能。如果希望样式对象是独立的，则需要先对其进行克隆，然后再分配它们。同样，默认情况下，如果电子表格实体共享相似的样式，则从文件（或流）中读取文档时，它们也将引用相同的样式对象。</p> <h3 id="数字格式⬆"><a href="#数字格式⬆" class="header-anchor">#</a> 数字格式<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 将值显示为“ 1 3/5”</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1.6</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numFmt <span class="token operator">=</span> <span class="token string">'# ?/?'</span><span class="token punctuation">;</span>

<span class="token comment">// 显示为“ 1.60％”</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">0.016</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numFmt <span class="token operator">=</span> <span class="token string">'0.00%'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="字体"><a href="#字体" class="header-anchor">#</a> 字体</h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>
<span class="token comment">// for the wannabe graphic designers out there</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Comic Sans MS'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">family</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
  <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">16</span><span class="token punctuation">,</span>
  <span class="token literal-property property">underline</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">bold</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// for the graduate graphic designers...</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Arial Black'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">'FF00FF00'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">family</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
  <span class="token literal-property property">italic</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 垂直对齐</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>font <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">vertAlign</span><span class="token operator">:</span> <span class="token string">'superscript'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 注意：该单元格将存储对分配的字体对象的引用。</span>
<span class="token comment">// 如果之后更改了字体对象，则单元字体也将更改。</span>
<span class="token keyword">const</span> font <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">'Arial'</span><span class="token punctuation">,</span> <span class="token literal-property property">size</span><span class="token operator">:</span> <span class="token number">12</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>font <span class="token operator">=</span> font<span class="token punctuation">;</span>
font<span class="token punctuation">.</span>size <span class="token operator">=</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token comment">// 单元格 A3 现在具有20号字体！</span>

<span class="token comment">// 从文件或流中读取工作簿后，共享相似字体的单元格可能引用相同的字体对象</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br></div></div><table><thead><tr><th>字体属性</th> <th>描述</th> <th>示例值</th></tr></thead> <tbody><tr><td>name</td> <td>字体名称。</td> <td>'Arial', 'Calibri', etc.</td></tr> <tr><td>family</td> <td>备用字体家族。整数值。</td> <td>1 - Serif, 2 - Sans Serif, 3 - Mono, Others - unknown</td></tr> <tr><td>scheme</td> <td>字体方案。</td> <td>'minor', 'major', 'none'</td></tr> <tr><td>charset</td> <td>字体字符集。整数值。</td> <td>1, 2, etc.</td></tr> <tr><td>size</td> <td>字体大小。整数值。</td> <td>9, 10, 12, 16, etc.</td></tr> <tr><td>color</td> <td>颜色描述，一个包含 ARGB 值的对象。</td> <td>{ argb: 'FFFF0000'}</td></tr> <tr><td>bold</td> <td>字体 <strong>粗细</strong></td> <td>true, false</td></tr> <tr><td>italic</td> <td>字体 <em>倾斜</em></td> <td>true, false</td></tr> <tr><td>underline</td> <td>字体 <u>下划线</u> 样式</td> <td>true, false, 'none', 'single', 'double', 'singleAccounting', 'doubleAccounting'</td></tr> <tr><td>strike</td> <td>字体 <strike>删除线</strike></td> <td>true, false</td></tr> <tr><td>outline</td> <td>字体轮廓</td> <td>true, false</td></tr> <tr><td>vertAlign</td> <td>垂直对齐</td> <td>'superscript', 'subscript'</td></tr></tbody></table> <h3 id="对齐⬆"><a href="#对齐⬆" class="header-anchor">#</a> 对齐<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 将单元格对齐方式设置为左上，中间居中，右下</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">vertical</span><span class="token operator">:</span> <span class="token string">'top'</span><span class="token punctuation">,</span> <span class="token literal-property property">horizontal</span><span class="token operator">:</span> <span class="token string">'left'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">vertical</span><span class="token operator">:</span> <span class="token string">'middle'</span><span class="token punctuation">,</span> <span class="token literal-property property">horizontal</span><span class="token operator">:</span> <span class="token string">'center'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'C1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">vertical</span><span class="token operator">:</span> <span class="token string">'bottom'</span><span class="token punctuation">,</span> <span class="token literal-property property">horizontal</span><span class="token operator">:</span> <span class="token string">'right'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 将单元格设置为自动换行</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'D1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">wrapText</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 将单元格缩进设置为1</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'E1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">indent</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 将单元格文本旋转设置为向上30deg，向下45deg和垂直文本</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'F1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">textRotation</span><span class="token operator">:</span> <span class="token number">30</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'G1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">textRotation</span><span class="token operator">:</span> <span class="token operator">-</span><span class="token number">45</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'H1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>alignment <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">textRotation</span><span class="token operator">:</span> <span class="token string">'vertical'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p><strong>有效的对齐属性值</strong></p> <table><thead><tr><th>水平的</th> <th>垂直</th> <th>文本换行</th> <th>自适应</th> <th>缩进</th> <th>阅读顺序</th> <th>文本旋转</th></tr></thead> <tbody><tr><td>left</td> <td>top</td> <td>true</td> <td>true</td> <td>integer</td> <td>rtl</td> <td>0 to 90</td></tr> <tr><td>center</td> <td>middle</td> <td>false</td> <td>false</td> <td></td> <td>ltr</td> <td>-1 to -90</td></tr> <tr><td>right</td> <td>bottom</td> <td></td> <td></td> <td></td> <td></td> <td>vertical</td></tr> <tr><td>fill</td> <td>distributed</td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>justify</td> <td>justify</td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>centerContinuous</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr> <tr><td>distributed</td> <td></td> <td></td> <td></td> <td></td> <td></td> <td></td></tr></tbody></table> <h3 id="边框⬆"><a href="#边框⬆" class="header-anchor">#</a> 边框<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 在A1周围设置单个细边框</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>border <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">style</span><span class="token operator">:</span><span class="token string">'thin'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">style</span><span class="token operator">:</span><span class="token string">'thin'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">bottom</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">style</span><span class="token operator">:</span><span class="token string">'thin'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">style</span><span class="token operator">:</span><span class="token string">'thin'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 在A3周围设置双细绿色边框</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>border <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">top</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">style</span><span class="token operator">:</span><span class="token string">'double'</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FF00FF00'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">left</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">style</span><span class="token operator">:</span><span class="token string">'double'</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FF00FF00'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">bottom</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">style</span><span class="token operator">:</span><span class="token string">'double'</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FF00FF00'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">right</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">style</span><span class="token operator">:</span><span class="token string">'double'</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FF00FF00'</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 在A5中设置厚红十字边框</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A5'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>border <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">diagonal</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">up</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">down</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token literal-property property">style</span><span class="token operator">:</span><span class="token string">'thick'</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FFFF0000'</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p><strong>有效边框样式</strong></p> <ul><li>thin</li> <li>dotted</li> <li>dashDot</li> <li>hair</li> <li>dashDotDot</li> <li>slantDashDot</li> <li>mediumDashed</li> <li>mediumDashDotDot</li> <li>mediumDashDot</li> <li>medium</li> <li>double</li> <li>thick</li></ul> <h3 id="填充⬆"><a href="#填充⬆" class="header-anchor">#</a> 填充<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 用红色深色垂直条纹填充A1</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fill <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'pattern'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">pattern</span><span class="token operator">:</span><span class="token string">'darkVertical'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">fgColor</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FFFF0000'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 在A2中填充深黄色格子和蓝色背景</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fill <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'pattern'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">pattern</span><span class="token operator">:</span><span class="token string">'darkTrellis'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">fgColor</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FFFFFF00'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">bgColor</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FF0000FF'</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 从左到右用蓝白蓝渐变填充A3</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fill <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'gradient'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">gradient</span><span class="token operator">:</span> <span class="token string">'angle'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">degree</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
  <span class="token literal-property property">stops</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token literal-property property">position</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FF0000FF'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token literal-property property">position</span><span class="token operator">:</span><span class="token number">0.5</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FFFFFFFF'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token literal-property property">position</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FF0000FF'</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>


<span class="token comment">// 从中心开始用红绿色渐变填充A4</span>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A4'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>fill <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'gradient'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">gradient</span><span class="token operator">:</span> <span class="token string">'path'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">center</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">left</span><span class="token operator">:</span><span class="token number">0.5</span><span class="token punctuation">,</span><span class="token literal-property property">top</span><span class="token operator">:</span><span class="token number">0.5</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">stops</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token literal-property property">position</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FFFF0000'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token literal-property property">position</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token literal-property property">color</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span><span class="token string">'FF00FF00'</span><span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h4 id="填充模式⬆"><a href="#填充模式⬆" class="header-anchor">#</a> 填充模式<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h4> <table><thead><tr><th>属性</th> <th>是否需要</th> <th>描述</th></tr></thead> <tbody><tr><td>type</td> <td>Y</td> <td>值: <code>'pattern'</code><br>指定此填充使用模式</td></tr> <tr><td>pattern</td> <td>Y</td> <td>指定模式类型 (查看下面 <a href="#有效模式类型">有效模式类型</a> )</td></tr> <tr><td>fgColor</td> <td>N</td> <td>指定图案前景色。默认为黑色。</td></tr> <tr><td>bgColor</td> <td>N</td> <td>指定图案背景色。默认为白色。</td></tr></tbody></table> <p><strong>有效模式类型</strong></p> <ul><li>none</li> <li>solid</li> <li>darkGray</li> <li>mediumGray</li> <li>lightGray</li> <li>gray125</li> <li>gray0625</li> <li>darkHorizontal</li> <li>darkVertical</li> <li>darkDown</li> <li>darkUp</li> <li>darkGrid</li> <li>darkTrellis</li> <li>lightHorizontal</li> <li>lightVertical</li> <li>lightDown</li> <li>lightUp</li> <li>lightGrid</li> <li>lightTrellis</li></ul> <h4 id="渐变填充⬆"><a href="#渐变填充⬆" class="header-anchor">#</a> 渐变填充<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h4> <table><thead><tr><th>属性</th> <th>是否需要</th> <th>描述</th></tr></thead> <tbody><tr><td>type</td> <td>Y</td> <td>值: <code>'gradient'</code><br>指定此填充使用渐变</td></tr> <tr><td>gradient</td> <td>Y</td> <td>指定渐变类型。<code>['angle'，'path']</code> 之一</td></tr> <tr><td>degree</td> <td>angle</td> <td>对于“角度”渐变，指定渐变的方向。<code>0</code> 是从左到右。值从 1-359 顺时针旋转方向</td></tr> <tr><td>center</td> <td>path</td> <td>对于“路径”渐变。指定路径起点的相对坐标。“左”和“顶”值的范围是 0 到 1</td></tr> <tr><td>stops</td> <td>Y</td> <td>指定渐变颜色序列。是包含位置和颜色（从位置 0 开始到位置 1 结束）的对象的数组。中间位置可用于指定路径上的其他颜色。</td></tr></tbody></table> <p><strong>注意事项</strong></p> <p>使用上面的接口，可能会创建使用XLSX编辑器程序无法实现的渐变填充效果。例如，Excel 仅支持0、45、90 和 135 的角度梯度。类似地，stops 的顺序也可能受到 UI 的限制，其中位置 [0,1] 或[0,0.5,1] 是唯一的选择。请谨慎处理此填充，以确保目标 XLSX 查看器支持该填充。</p> <h3 id="富文本⬆"><a href="#富文本⬆" class="header-anchor">#</a> 富文本<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>现在，单个单元格支持RTF文本或单元格格式化。富文本值可以控制文本值内任意数量的子字符串的字体属性。有关支持哪些字体属性的详细信息，请参见<a href="font">字体</a>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>
ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string-property property">'richText'</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span><span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'theme'</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span><span class="token string-property property">'family'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">'This is '</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'italic'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span><span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'theme'</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span><span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">'a'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span><span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'theme'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span><span class="token string-property property">'family'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">' '</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span><span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'argb'</span><span class="token operator">:</span> <span class="token string">'FFFF6600'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span><span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">'colorful'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span><span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'theme'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span><span class="token string-property property">'family'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">' text '</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span><span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'argb'</span><span class="token operator">:</span> <span class="token string">'FFCCFFCC'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span><span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">'with'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span><span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'theme'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span><span class="token string-property property">'family'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">' in-cell '</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string-property property">'font'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'bold'</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token string-property property">'size'</span><span class="token operator">:</span> <span class="token number">12</span><span class="token punctuation">,</span><span class="token string-property property">'color'</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string-property property">'theme'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'name'</span><span class="token operator">:</span> <span class="token string">'Calibri'</span><span class="token punctuation">,</span><span class="token string-property property">'family'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span><span class="token string-property property">'scheme'</span><span class="token operator">:</span> <span class="token string">'minor'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token string-property property">'text'</span><span class="token operator">:</span> <span class="token string">'format'</span><span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token function">expect</span><span class="token punctuation">(</span>ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token string">'This is a colorful text with in-cell format'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span>Excel<span class="token punctuation">.</span>ValueType<span class="token punctuation">.</span>RichText<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="单元格保护⬆"><a href="#单元格保护⬆" class="header-anchor">#</a> 单元格保护<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>可以使用保护属性来修改单元级别保护。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>ws<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>protection <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">locked</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">hidden</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p><strong>支持的保护属性</strong></p> <table><thead><tr><th>属性</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>locked</td> <td><code>true</code></td> <td>指定在工作表受保护的情况下是否将单元格锁定。</td></tr> <tr><td>hidden</td> <td><code>false</code></td> <td>指定如果工作表受保护，则单元格的公式是否可见。</td></tr></tbody></table> <h2 id="条件格式化⬆"><a href="#条件格式化⬆" class="header-anchor">#</a> 条件格式化<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>条件格式化允许工作表根据单元格值或任意公式显示特定的样式，图标等。</p> <p>条件格式设置规则是在工作表级别添加的，通常会覆盖一系列单元格。</p> <p>可以将多个规则应用于给定的单元格范围，并且每个规则都将应用自己的样式。</p> <p>如果多个规则影响给定的单元格，则规则优先级值将确定如果竞争样式冲突，则哪个规则胜出。优先级值较低的规则获胜。如果没有为给定规则指定优先级值，ExcelJS 将按升序分配它们。</p> <p>注意：目前，仅支持条件格式设置规则的子集。具体来说，只有格式规则不需要 &lt;extLst&amp;gt 元素内的 XML 呈现。这意味着不支持数据集和三个特定的图标集（3Triangles，3Stars，5Boxes）。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 根据行和列为偶数或奇数向 A1:E7 添加一个棋盘图案</span>
worksheet<span class="token punctuation">.</span><span class="token function">addConditionalFormatting</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'A1:E7'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">rules</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'expression'</span><span class="token punctuation">,</span>
      <span class="token literal-property property">formulae</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'MOD(ROW()+COLUMN(),2)=0'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">fill</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'pattern'</span><span class="token punctuation">,</span> <span class="token literal-property property">pattern</span><span class="token operator">:</span> <span class="token string">'solid'</span><span class="token punctuation">,</span> <span class="token literal-property property">bgColor</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">argb</span><span class="token operator">:</span> <span class="token string">'FF00FF00'</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>支持的条件格式设置规则类型</strong></p> <table><thead><tr><th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>expression</td> <td>任何自定义功能均可用于激活规则。</td></tr> <tr><td>cellIs</td> <td>使用指定的运算符将单元格值与提供的公式进行比较</td></tr> <tr><td>top10</td> <td>将格式化应用于值在顶部（或底部）范围内的单元格</td></tr> <tr><td>aboveAverage</td> <td>将格式化应用于值高于（或低于）平均值的单元格</td></tr> <tr><td>colorScale</td> <td>根据其值在范围内的位置将彩色背景应用于单元格</td></tr> <tr><td>iconSet</td> <td>根据值将一系列图标之一添加到单元格</td></tr> <tr><td>containsText</td> <td>根据单元格是否为特定文本来应用格式</td></tr> <tr><td>timePeriod</td> <td>根据单元格日期时间值是否在指定范围内应用格式</td></tr></tbody></table> <h3 id="表达式⬆"><a href="#表达式⬆" class="header-anchor">#</a> 表达式<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <table><thead><tr><th>属性</th> <th>可选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>type</td> <td></td> <td></td> <td><code>'expression'</code></td></tr> <tr><td>priority</td> <td>Y</td> <td>&lt;auto&gt;</td> <td>确定样式的优先顺序</td></tr> <tr><td>formulae</td> <td></td> <td></td> <td>1个包含真/假值的公式字符串数组。要引用单元格值，请使用左上角的单元格地址</td></tr> <tr><td>style</td> <td></td> <td></td> <td>公式返回 <code>true</code> 时要应用的样式结构</td></tr></tbody></table> <h3 id="cell-is⬆"><a href="#cell-is⬆" class="header-anchor">#</a> Cell Is<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <table><thead><tr><th>属性</th> <th>可选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>type</td> <td></td> <td></td> <td><code>'cellIs'</code></td></tr> <tr><td>priority</td> <td>Y</td> <td>&lt;auto&gt;</td> <td>确定样式的优先顺序</td></tr> <tr><td>operator</td> <td></td> <td></td> <td>如何将单元格值与公式结果进行比较</td></tr> <tr><td>formulae</td> <td></td> <td></td> <td>1个公式字符串数组，返回要与每个单元格进行比较的值</td></tr> <tr><td>style</td> <td></td> <td></td> <td>如果比较返回 <code>true</code>，则应用样式结构</td></tr></tbody></table> <p><strong>Cell Is 运算符</strong></p> <table><thead><tr><th>运算</th> <th>描述</th></tr></thead> <tbody><tr><td>equal</td> <td>如果单元格值等于公式值，则应用格式</td></tr> <tr><td>greaterThan</td> <td>如果单元格值大于公式值，则应用格式</td></tr> <tr><td>lessThan</td> <td>如果单元格值小于公式值，则应用格式</td></tr> <tr><td>between</td> <td>如果单元格值在两个公式值之间（包括两个值），则应用格式</td></tr></tbody></table> <h3 id="top-10⬆"><a href="#top-10⬆" class="header-anchor">#</a> Top 10<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <table><thead><tr><th>属性</th> <th>可选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>type</td> <td></td> <td></td> <td><code>'top10'</code></td></tr> <tr><td>priority</td> <td>Y</td> <td>&lt;auto&gt;</td> <td>确定样式的优先顺序</td></tr> <tr><td>rank</td> <td>Y</td> <td>10</td> <td>指定格式中包含多少个顶部（或底部）值</td></tr> <tr><td>percent</td> <td>Y</td> <td><code>false</code></td> <td>如果为 true，则等级字段为百分比，而不是绝对值</td></tr> <tr><td>bottom</td> <td>Y</td> <td><code>false</code></td> <td>如果为 true，则包含最低值而不是最高值</td></tr> <tr><td>style</td> <td></td> <td></td> <td>如果比较返回 true，则应用样式结构</td></tr></tbody></table> <h3 id="高于平均值⬆"><a href="#高于平均值⬆" class="header-anchor">#</a> 高于平均值<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <table><thead><tr><th>属性</th> <th>可选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>type</td> <td></td> <td></td> <td><code>'aboveAverage'</code></td></tr> <tr><td>priority</td> <td>Y</td> <td>&lt;auto&gt;</td> <td>确定样式的优先顺序</td></tr> <tr><td>aboveAverage</td> <td>Y</td> <td><code>false</code></td> <td>如果为 true，则等级字段为百分比，而不是绝对值</td></tr> <tr><td>style</td> <td></td> <td></td> <td>如果比较返回 true，则应用样式结构</td></tr></tbody></table> <h3 id="色阶⬆"><a href="#色阶⬆" class="header-anchor">#</a> 色阶<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <table><thead><tr><th>属性</th> <th>可选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>type</td> <td></td> <td></td> <td><code>'colorScale'</code></td></tr> <tr><td>priority</td> <td>Y</td> <td>&lt;auto&gt;</td> <td>确定样式的优先顺序</td></tr> <tr><td>cfvo</td> <td></td> <td></td> <td>2到5个条件格式化值对象的数组，指定值范围内的航路点</td></tr> <tr><td>color</td> <td></td> <td></td> <td>在给定的航路点使用的相应颜色数组</td></tr> <tr><td>style</td> <td></td> <td></td> <td>如果比较返回 true，则应用样式结构</td></tr></tbody></table> <h3 id="图标集⬆"><a href="#图标集⬆" class="header-anchor">#</a> 图标集<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <table><thead><tr><th>属性</th> <th>可选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>type</td> <td></td> <td></td> <td><code>'iconSet'</code></td></tr> <tr><td>priority</td> <td>Y</td> <td>&lt;auto&gt;</td> <td>确定样式的优先顺序</td></tr> <tr><td>iconSet</td> <td>Y</td> <td>3TrafficLights</td> <td>设置使用的图标名称</td></tr> <tr><td>showValue</td> <td></td> <td>true</td> <td>指定应用范围内的单元格是显示图标和单元格值，还是仅显示图标</td></tr> <tr><td>reverse</td> <td></td> <td>false</td> <td>指定是否以保留顺序显示 <code>iconSet</code> 中指定的图标集中的图标。 如果 <code>custom</code> 等于 <code>true</code>，则必须忽略此值</td></tr> <tr><td>custom</td> <td></td> <td>false</td> <td>指定是否使用自定义图标集</td></tr> <tr><td>cfvo</td> <td></td> <td></td> <td>2到5个条件格式化值对象的数组，指定值范围内的航路点</td></tr> <tr><td>style</td> <td></td> <td></td> <td>如果比较返回 true，则应用样式结构</td></tr></tbody></table> <h3 id="数据条⬆"><a href="#数据条⬆" class="header-anchor">#</a> 数据条<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <table><thead><tr><th>字段</th> <th>可选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>type</td> <td></td> <td></td> <td><code>'dataBar'</code></td></tr> <tr><td>priority</td> <td>Y</td> <td>&lt;auto&gt;</td> <td>确定样式的优先顺序</td></tr> <tr><td>minLength</td> <td></td> <td>0</td> <td>指定此条件格式范围内最短数据条的长度</td></tr> <tr><td>maxLength</td> <td></td> <td>100</td> <td>指定此条件格式范围内最长数据条的长度</td></tr> <tr><td>showValue</td> <td></td> <td>true</td> <td>指定条件格式范围内的单元格是否同时显示数据条和数值或数据条</td></tr> <tr><td>gradient</td> <td></td> <td>true</td> <td>指定数据条是否具有渐变填充</td></tr> <tr><td>border</td> <td></td> <td>true</td> <td>指定数据条是否有边框</td></tr> <tr><td>negativeBarColorSameAsPositive</td> <td></td> <td>true</td> <td>指定数据条是否具有与正条颜色不同的负条颜色</td></tr> <tr><td>negativeBarBorderColorSameAsPositive</td> <td></td> <td>true</td> <td>指定数据条的负边框颜色是否不同于正边框颜色</td></tr> <tr><td>axisPosition</td> <td></td> <td>'auto'</td> <td>指定数据条的轴位置</td></tr> <tr><td>direction</td> <td></td> <td>'leftToRight'</td> <td>指定数据条的方向</td></tr> <tr><td>cfvo</td> <td></td> <td></td> <td>2 到 5 个条件格式化值对象的数组，指定值范围内的航路点</td></tr> <tr><td>style</td> <td></td> <td></td> <td>如果比较返回 true，则应用样式结构</td></tr></tbody></table> <h3 id="包含文字⬆"><a href="#包含文字⬆" class="header-anchor">#</a> 包含文字<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <table><thead><tr><th>属性</th> <th>可选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>type</td> <td></td> <td></td> <td><code>'containsText'</code></td></tr> <tr><td>priority</td> <td>Y</td> <td>&lt;auto&gt;</td> <td>确定样式的优先顺序</td></tr> <tr><td>operator</td> <td></td> <td></td> <td>文本比较类型</td></tr> <tr><td>text</td> <td></td> <td></td> <td>要搜索的文本</td></tr> <tr><td>style</td> <td></td> <td></td> <td>如果比较返回 true，则应用样式结构</td></tr></tbody></table> <p><strong>包含文本运算符</strong></p> <table><thead><tr><th>运算符</th> <th>描述</th></tr></thead> <tbody><tr><td>containsText</td> <td>如果单元格值包含在 <code>text</code> 字段中指定的值，则应用格式</td></tr> <tr><td>containsBlanks</td> <td>如果单元格值包含空格，则应用格式</td></tr> <tr><td>notContainsBlanks</td> <td>如果单元格值不包含空格，则应用格式</td></tr> <tr><td>containsErrors</td> <td>如果单元格值包含错误，则应用格式</td></tr> <tr><td>notContainsErrors</td> <td>如果单元格值不包含错误，则应用格式</td></tr></tbody></table> <h3 id="时间段⬆"><a href="#时间段⬆" class="header-anchor">#</a> 时间段<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <table><thead><tr><th>属性</th> <th>可选</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>type</td> <td></td> <td></td> <td><code>'timePeriod'</code></td></tr> <tr><td>priority</td> <td>Y</td> <td>&lt;auto&gt;</td> <td>确定样式的优先顺序</td></tr> <tr><td>timePeriod</td> <td></td> <td></td> <td>比较单元格值的时间段</td></tr> <tr><td>style</td> <td></td> <td></td> <td>如果比较返回 true，则应用样式结构</td></tr></tbody></table> <p><strong>时间段</strong></p> <table><thead><tr><th>时间段</th> <th>描述</th></tr></thead> <tbody><tr><td>lastWeek</td> <td>如果单元格值落在最后一周内，则应用格式</td></tr> <tr><td>thisWeek</td> <td>如果单元格值在本周下降，则应用格式</td></tr> <tr><td>nextWeek</td> <td>如果单元格值在下一周下降，则应用格式</td></tr> <tr><td>yesterday</td> <td>如果单元格值等于昨天，则应用格式</td></tr> <tr><td>today</td> <td>如果单元格值等于今天，则应用格式</td></tr> <tr><td>tomorrow</td> <td>如果单元格值等于明天，则应用格式</td></tr> <tr><td>last7Days</td> <td>如果单元格值在过去7天之内，则应用格式</td></tr> <tr><td>lastMonth</td> <td>如果单元格值属于上个月，则应用格式</td></tr> <tr><td>thisMonth</td> <td>如果单元格值在本月下降，则应用格式</td></tr> <tr><td>nextMonth</td> <td>如果单元格值在下个月下降，则应用格式</td></tr></tbody></table> <h2 id="大纲级别⬆"><a href="#大纲级别⬆" class="header-anchor">#</a> 大纲级别<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>Excel 支持大纲；行或列可以根据用户希望查看的详细程度展开或折叠。</p> <p>大纲级别可以在列设置中定义：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span>columns <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">'Id'</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'id'</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">'Name'</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'name'</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">32</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> <span class="token literal-property property">header</span><span class="token operator">:</span> <span class="token string">'D.O.B.'</span><span class="token punctuation">,</span> <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'DOB'</span><span class="token punctuation">,</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token literal-property property">outlineLevel</span><span class="token operator">:</span> <span class="token number">1</span> <span class="token punctuation">}</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>或直接在行或列上</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>outlineLevel <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>outlineLevel <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>工作表大纲级别可以在工作表上设置</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 设置列大纲级别</span>
worksheet<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>outlineLevelCol <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">// 设置行大纲级别</span>
worksheet<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>outlineLevelRow <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>注意：调整行或列上的大纲级别或工作表上的大纲级别将产生副作用，即还修改受属性更改影响的所有行或列的折叠属性。 例如。：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>outlineLevelCol <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>outlineLevel <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>collapsed<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span><span class="token boolean">true</span><span class="token punctuation">;</span>

worksheet<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>outlineLevelCol <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getColumn</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">.</span>collapsed<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span>be<span class="token punctuation">.</span><span class="token boolean">false</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>大纲属性可以在工作表上设置</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span>properties<span class="token punctuation">.</span>outlineProperties <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">summaryBelow</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token literal-property property">summaryRight</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="图片⬆"><a href="#图片⬆" class="header-anchor">#</a> 图片<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>将图像添加到工作表是一个分为两个步骤的过程。首先，通过 <code>addImage()</code> 函数将图像添加到工作簿中，该函数还将返回 <code>imageId</code> 值。然后，使用 <code>imageId</code>，可以将图像作为平铺背景或覆盖单元格区域添加到工作表中。</p> <p>注意：从此版本开始，不支持调整或变换图像。</p> <h3 id="将图片添加到工作簿⬆"><a href="#将图片添加到工作簿⬆" class="header-anchor">#</a> 将图片添加到工作簿<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p><code>Workbook.addImage</code> 函数支持按文件名或按 <code>Buffer</code> 添加图像。请注意，在两种情况下，都必须指定扩展名。有效的扩展名包括 “jpeg”，“png”，“gif”。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 通过文件名将图像添加到工作簿</span>
<span class="token keyword">const</span> imageId1 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'path/to/image.jpg'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">extension</span><span class="token operator">:</span> <span class="token string">'jpeg'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 通过 buffer 将图像添加到工作簿</span>
<span class="token keyword">const</span> imageId2 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">buffer</span><span class="token operator">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token string">'path/to.image.png'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token literal-property property">extension</span><span class="token operator">:</span> <span class="token string">'png'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 通过 base64  将图像添加到工作簿</span>
<span class="token keyword">const</span> myBase64Image <span class="token operator">=</span> <span class="token string">&quot;data:image/png;base64,iVBORw0KG...&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> imageId2 <span class="token operator">=</span> workbook<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">base64</span><span class="token operator">:</span> myBase64Image<span class="token punctuation">,</span>
  <span class="token literal-property property">extension</span><span class="token operator">:</span> <span class="token string">'png'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="将图片添加到工作表背景⬆"><a href="#将图片添加到工作表背景⬆" class="header-anchor">#</a> 将图片添加到工作表背景<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>使用 <code>Workbook.addImage</code> 中的图像 <code>ID</code>，可以使用 <code>addBackgroundImage</code> 函数设置工作表的背景</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 设置背景</span>
worksheet<span class="token punctuation">.</span><span class="token function">addBackgroundImage</span><span class="token punctuation">(</span>imageId1<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="在一定范围内添加图片⬆"><a href="#在一定范围内添加图片⬆" class="header-anchor">#</a> 在一定范围内添加图片<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>使用 <code>Workbook.addImage</code> 中的图像 <code>ID</code>，可以将图像嵌入工作表中以覆盖一定范围。从该范围计算出的坐标将覆盖从第一个单元格的左上角到第二个单元格的右下角。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 在 B2:D6 上插入图片</span>
worksheet<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span>imageId2<span class="token punctuation">,</span> <span class="token string">'B2:D6'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>使用结构而不是范围字符串，可以部分覆盖单元格。</p> <p>请注意，为此使用的坐标系基于零，因此 A1 的左上角将为 <code>{col：0，row：0}</code>。单元格的分数可以通过使用浮点数来指定，例如 A1 的中点是 <code>{col：0.5，row：0.5}</code>。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 在 B2:D6 的一部分上插入图像</span>
worksheet<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span>imageId2<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">tl</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">col</span><span class="token operator">:</span> <span class="token number">1.5</span><span class="token punctuation">,</span> <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token number">1.5</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">br</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">col</span><span class="token operator">:</span> <span class="token number">3.5</span><span class="token punctuation">,</span> <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token number">5.5</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>单元格区域还可以具有属性 <code>&quot;editAs&quot;</code>，该属性将控制将图像锚定到单元格的方式。它可以具有以下值之一：</p> <table><thead><tr><th>值</th> <th>描述</th></tr></thead> <tbody><tr><td><code>undefined</code></td> <td>它指定使图像将根据单元格移动和调整其大小</td></tr> <tr><td><code>oneCell</code></td> <td>这是默认值。图像将与单元格一起移动，但大小不变动</td></tr> <tr><td><code>absolute</code></td> <td>图像将不会随着单元格移动或调整大小</td></tr></tbody></table> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>ws<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span>imageId<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">tl</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">col</span><span class="token operator">:</span> <span class="token number">0.1125</span><span class="token punctuation">,</span> <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token number">0.4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">br</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">col</span><span class="token operator">:</span> <span class="token number">2.101046875</span><span class="token punctuation">,</span> <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token number">3.4</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">editAs</span><span class="token operator">:</span> <span class="token string">'oneCell'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="将图片添加到单元格⬆"><a href="#将图片添加到单元格⬆" class="header-anchor">#</a> 将图片添加到单元格<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>您可以将图像添加到单元格，然后以 96dpi 定义其宽度和高度（以像素为单位）。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span>imageId2<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">tl</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">col</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">ext</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="添加带有超链接的图片⬆"><a href="#添加带有超链接的图片⬆" class="header-anchor">#</a> 添加带有超链接的图片<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>您可以将带有超链接的图像添加到单元格，并在图像范围内定义超链接。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span>imageId2<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">tl</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">col</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token literal-property property">row</span><span class="token operator">:</span> <span class="token number">0</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">ext</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">width</span><span class="token operator">:</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token literal-property property">height</span><span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token literal-property property">hyperlinks</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">hyperlink</span><span class="token operator">:</span> <span class="token string">'http://www.somewhere.com'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">tooltip</span><span class="token operator">:</span> <span class="token string">'http://www.somewhere.com'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="工作表保护⬆"><a href="#工作表保护⬆" class="header-anchor">#</a> 工作表保护<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>可以通过添加密码来保护工作表免受修改。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">await</span> worksheet<span class="token punctuation">.</span><span class="token function">protect</span><span class="token punctuation">(</span><span class="token string">'the-password'</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>工作表保护也可以删除：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">unprotect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>有关如何修改单个单元格保护的详细信息请查看 <a href="#单元格保护">单元格保护</a>。</p> <p><strong>注意：</strong> 当 <code>protect()</code> 函数返回一个 Promise 代表它是异步的，当前的实现在主线程上运行，并且在 CPU 上将使用平均大约 600 毫秒。可以通过设置 <code>spinCount</code> 进行调整，该值可用于使过程更快或更有弹性。</p> <h3 id="工作表保护选项⬆"><a href="#工作表保护选项⬆" class="header-anchor">#</a> 工作表保护选项<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <table><thead><tr><th>属性</th> <th>默认值</th> <th>描述</th></tr></thead> <tbody><tr><td>selectLockedCells</td> <td><code>true</code></td> <td>允许用户选择锁定的单元格</td></tr> <tr><td>selectUnlockedCells</td> <td><code>true</code></td> <td>允许用户选择未锁定的单元格</td></tr> <tr><td>formatCells</td> <td><code>false</code></td> <td>允许用户格式化单元格</td></tr> <tr><td>formatColumns</td> <td><code>false</code></td> <td>允许用户格式化列</td></tr> <tr><td>formatRows</td> <td><code>false</code></td> <td>允许用户格式化行</td></tr> <tr><td>insertRows</td> <td><code>false</code></td> <td>允许用户插入行</td></tr> <tr><td>insertColumns</td> <td><code>false</code></td> <td>允许用户插入列</td></tr> <tr><td>insertHyperlinks</td> <td><code>false</code></td> <td>允许用户插入超链接</td></tr> <tr><td>deleteRows</td> <td><code>false</code></td> <td>允许用户删除行</td></tr> <tr><td>deleteColumns</td> <td><code>false</code></td> <td>允许用户删除列</td></tr> <tr><td>sort</td> <td><code>false</code></td> <td>允许用户对数据进行排序</td></tr> <tr><td>autoFilter</td> <td><code>false</code></td> <td>允许用户过滤表中的数据</td></tr> <tr><td>pivotTables</td> <td><code>false</code></td> <td>允许用户使用数据透视表</td></tr> <tr><td>spinCount</td> <td>100000</td> <td>保护或取消保护时执行的哈希迭代次数</td></tr></tbody></table> <h2 id="文件-i-o⬆"><a href="#文件-i-o⬆" class="header-anchor">#</a> 文件 I/O<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <h3 id="xlsx⬆"><a href="#xlsx⬆" class="header-anchor">#</a> XLSX<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <h4 id="读-xlsx⬆"><a href="#读-xlsx⬆" class="header-anchor">#</a> 读 XLSX<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 从文件读取</span>
<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Excel<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ... 使用 workbook</span>


<span class="token comment">// 从流读取</span>
<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Excel<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ... 使用 workbook</span>


<span class="token comment">// 从 buffer 加载</span>
<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Excel<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ... 使用 workbook</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="写-xlsx"><a href="#写-xlsx" class="header-anchor">#</a> 写 XLSX</h4> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 写入文件</span>
<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token function">createAndFillWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 写入流</span>
<span class="token keyword">await</span> workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 写入 buffer</span>
<span class="token keyword">const</span> buffer <span class="token operator">=</span> <span class="token keyword">await</span> workbook<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="csv⬆"><a href="#csv⬆" class="header-anchor">#</a> CSV<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <h4 id="读-csv⬆"><a href="#读-csv⬆" class="header-anchor">#</a> 读 CSV<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h4> <p>读取 CSV 文件时支持的选项。</p> <table><thead><tr><th>属性</th> <th>是否需要</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>dateFormats</td> <td>N</td> <td>Array</td> <td>指定 dayjs 的日期编码格式。</td></tr> <tr><td>map</td> <td>N</td> <td>Function</td> <td>自定义<code>Array.prototype.map()</code> 回调函数，用于处理数据。</td></tr> <tr><td>sheetName</td> <td>N</td> <td>String</td> <td>指定工作表名称。</td></tr> <tr><td>parserOptions</td> <td>N</td> <td>Object</td> <td><a href="https://c2fo.io/fast-csv/docs/parsing/options" target="_blank" rel="noopener noreferrer">parseOptions 选项<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>  @fast-csv/format 模块以写入 csv 数据。</td></tr></tbody></table> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 从文件读取</span>
<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Excel<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> worksheet <span class="token operator">=</span> <span class="token keyword">await</span> workbook<span class="token punctuation">.</span>csv<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ... 使用 workbook 或 worksheet</span>


<span class="token comment">// 从流中读取</span>
<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Excel<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> worksheet <span class="token operator">=</span> <span class="token keyword">await</span> workbook<span class="token punctuation">.</span>csv<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>stream<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ... 使用 workbook 或 worksheet</span>


<span class="token comment">// 从带有欧洲日期的文件中读取</span>
<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Excel<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">dateFormats</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'DD/MM/YYYY'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> worksheet <span class="token operator">=</span> <span class="token keyword">await</span> workbook<span class="token punctuation">.</span>csv<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ... 使用 workbook 或 worksheet</span>


<span class="token comment">// 从具有自定义值解析的文件中读取</span>
<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Excel<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
        <span class="token comment">// 第1列是字符串</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
        <span class="token comment">// 第2列是日期</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
        <span class="token comment">// 第3列是公式值的JSON</span>
        <span class="token keyword">return</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token comment">// 其余的是数字</span>
        <span class="token keyword">return</span> <span class="token function">parseFloat</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// https://c2fo.io/fast-csv/docs/parsing/options</span>
  <span class="token literal-property property">parserOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">delimiter</span><span class="token operator">:</span> <span class="token string">'\t'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">quote</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> worksheet <span class="token operator">=</span> <span class="token keyword">await</span> workbook<span class="token punctuation">.</span>csv<span class="token punctuation">.</span><span class="token function">readFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ... 使用 workbook 或 worksheet</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><p>CSV 解析器使用 <a href="https://www.npmjs.com/package/fast-csv" target="_blank" rel="noopener noreferrer">fast-csv<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 读取CSV文件。传递给上述写入函数的选项中的 <code>formatterOptions</code> 将传递给 @fast-csv/format 模块以写入 csv 数据。 有关详细信息，请参阅 fast-csv README.md。</p> <p>使用 npm 模块 <a href="https://www.npmjs.com/package/dayjs" target="_blank" rel="noopener noreferrer">dayjs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 解析日期。如果未提供 <code>dateFormats</code> 数组，则使用以下 dateFormats：</p> <ul><li>'YYYY-MM-DD[T]HH:mm:ss'</li> <li>'MM-DD-YYYY'</li> <li>'YYYY-MM-DD'</li></ul> <p>请参阅 <a href="https://github.com/iamkun/dayjs/blob/HEAD/docs/en/Plugin.md#customparseformat" target="_blank" rel="noopener noreferrer">dayjs CustomParseFormat 插件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>，以获取有关如何构造 <code>dateFormat</code> 的详细信息。</p> <h4 id="写-csv⬆"><a href="#写-csv⬆" class="header-anchor">#</a> 写 CSV<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h4> <p>写入 CSV 文件时支持的选项。</p> <table><thead><tr><th>属性</th> <th>是否需要</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>dateFormat</td> <td>N</td> <td>String</td> <td>指定 dayjs 的日期编码格式。</td></tr> <tr><td>dateUTC</td> <td>N</td> <td>Boolean</td> <td>指定 ExcelJS 是否使用<code>dayjs.utc()</code>转换时区以解析日期。</td></tr> <tr><td>encoding</td> <td>N</td> <td>String</td> <td>指定文件编码格式。</td></tr> <tr><td>includeEmptyRows</td> <td>N</td> <td>Boolean</td> <td>指定是否可以写入空行。</td></tr> <tr><td>map</td> <td>N</td> <td>Function</td> <td>自定义<code>Array.prototype.map()</code> 回调函数，用于处理行值。</td></tr> <tr><td>sheetName</td> <td>N</td> <td>String</td> <td>指定工作表名称。</td></tr> <tr><td>sheetId</td> <td>N</td> <td>Number</td> <td>指定工作表 ID。</td></tr> <tr><td>formatterOptions</td> <td>N</td> <td>Object</td> <td><a href="https://c2fo.io/fast-csv/docs/formatting/options/" target="_blank" rel="noopener noreferrer">formatterOptions 选项<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> @fast-csv/format 模块写入csv 数据。</td></tr></tbody></table> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>
<span class="token comment">// 写入文件</span>
<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token function">createAndFillWorkbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> workbook<span class="token punctuation">.</span>csv<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 写入流</span>
<span class="token comment">// 请注意，您需要提供 sheetName 或 sheetId 以正确导入到 csv</span>
<span class="token keyword">await</span> workbook<span class="token punctuation">.</span>csv<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>stream<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">sheetName</span><span class="token operator">:</span> <span class="token string">'Page name'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 使用欧洲日期时间写入文件</span>
<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Excel<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">dateFormat</span><span class="token operator">:</span> <span class="token string">'DD/MM/YYYY HH:mm:ss'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">dateUTC</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 呈现日期时使用 utc</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> workbook<span class="token punctuation">.</span>csv<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token comment">// 使用自定义值格式写入文件</span>
<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Excel<span class="token punctuation">.</span>Workbook</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> index</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">switch</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">case</span> <span class="token number">0</span><span class="token operator">:</span>
        <span class="token comment">// 第1列是字符串</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token number">1</span><span class="token operator">:</span>
        <span class="token comment">// 第2列是日期</span>
        <span class="token keyword">return</span> <span class="token function">dayjs</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">'YYYY-MM-DD'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">case</span> <span class="token number">2</span><span class="token operator">:</span>
        <span class="token comment">// 第3列是一个公式，只写结果</span>
        <span class="token keyword">return</span> value<span class="token punctuation">.</span>result<span class="token punctuation">;</span>
      <span class="token keyword">default</span><span class="token operator">:</span>
        <span class="token comment">// 其余的是数字</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token comment">// https://c2fo.io/fast-csv/docs/formatting/options</span>
  <span class="token literal-property property">formatterOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">delimiter</span><span class="token operator">:</span> <span class="token string">'\t'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">quote</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> workbook<span class="token punctuation">.</span>csv<span class="token punctuation">.</span><span class="token function">writeFile</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 写入新 buffer</span>
<span class="token keyword">const</span> buffer <span class="token operator">=</span> <span class="token keyword">await</span> workbook<span class="token punctuation">.</span>csv<span class="token punctuation">.</span><span class="token function">writeBuffer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p>CSV 解析器使用 <a href="https://www.npmjs.com/package/fast-csv" target="_blank" rel="noopener noreferrer">fast-csv<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 编写 CSV 文件。传递给上述写入函数的选项中的 <code>formatterOptions</code> 将传递给 @fast-csv/format 模块以写入 csv 数据。有关详细信息，请参阅 fast-csv README.md。</p> <p>日期使用 npm 模块 <a href="https://www.npmjs.com/package/dayjs" target="_blank" rel="noopener noreferrer">dayjs<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 格式化。如果未提供 <code>dateFormat</code>，则使用 <code>dayjs.ISO_8601</code>。编写 CSV 时，您可以提供布尔值 <code>dateUTC</code> 为 <code>true</code>，以使 ExcelJS 解析日期，而无需使用 <code>dayjs.utc()</code> 自动转换时区。</p> <h3 id="流式-i-o⬆"><a href="#流式-i-o⬆" class="header-anchor">#</a> 流式 I/O<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>上面记录的文件 I/O 需要在内存中建立整个工作簿，然后才能写入文件。虽然方便，但是由于所需的内存量，它可能会限制文档的大小。</p> <p>流写入器（或读取器）在生成工作簿或工作表数据时对其进行处理，然后将其转换为文件形式。通常，这在内存上效率要高得多，因为最终的内存占用量，甚至中间的内存占用量都比文档版本要紧凑得多，尤其是当您考虑到行和单元格对象一旦提交就被销毁时，尤其如此。</p> <p>流式工作簿和工作表的接口几乎与文档版本相同，但实际存在一些细微差别：</p> <ul><li>将工作表添加到工作簿后，将无法将其删除。</li> <li>提交行后，将无法再访问该行，因为该行将从工作表中删除。</li> <li>不支持 <code>unMergeCells()</code>。</li></ul> <p>请注意，可以在不提交任何行的情况下构建整个工作簿。提交工作簿后，所有添加的工作表（包括所有未提交的行）将自动提交。但是，在这种情况下，与文档版本相比收效甚微。</p> <h4 id="流式-xlsx⬆"><a href="#流式-xlsx⬆" class="header-anchor">#</a> 流式 XLSX<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h4> <h5 id="流式-xlsx-写入器⬆"><a href="#流式-xlsx-写入器⬆" class="header-anchor">#</a> 流式 XLSX 写入器<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h5> <p>流式 XLSX 写入器在 <code>ExcelJS.stream.xlsx</code> 命名空间中可用。</p> <p>构造函数采用带有以下字段的可选 <code>options</code> 对象：</p> <table><thead><tr><th>字段</th> <th>描述</th></tr></thead> <tbody><tr><td>stream</td> <td>指定要写入 XLSX 工作簿的可写流。</td></tr> <tr><td>filename</td> <td>如果未指定流，则此字段指定要写入 XLSX 工作簿的文件的路径。</td></tr> <tr><td>useSharedStrings</td> <td>指定是否在工作簿中使用共享字符串。默认为 <code>false</code></td></tr> <tr><td>useStyles</td> <td>指定是否将样式信息添加到工作簿。样式会增加一些性能开销。默认为 <code>false</code></td></tr> <tr><td>zip</td> <td>ExcelJS 内部传递给 <a href="https://github.com/archiverjs/node-archiver" target="_blank" rel="noopener noreferrer">Archiver<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 的 <a href="https://www.archiverjs.com/global.html#ZipOptions" target="_blank" rel="noopener noreferrer">Zip选项<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>。默认值为 <code>undefined</code></td></tr></tbody></table> <p>如果在选项中未指定 <code>stream</code> 或 <code>filename</code>，则工作簿编写器将创建一个 StreamBuf 对象，该对象将 XLSX 工作簿的内容存储在内存中。可以通过属性 <code>workbook.stream</code> 访问此 StreamBuf 对象，该对象可用于通过 <code>stream.read()</code> 直接访问字节，或将内容通过管道传输到另一个流。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 使用样式和共享字符串构造流式 XLSX 工作簿编写器</span>
<span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">filename</span><span class="token operator">:</span> <span class="token string">'./streamed-workbook.xlsx'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">useStyles</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token literal-property property">useSharedStrings</span><span class="token operator">:</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Excel<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span>WorkbookWriter</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>通常，流式 XLSX 写入器的接口与上述文档工作簿（和工作表）相同，实际上行，单元格和样式对象是相同的。</p> <p>但是有一些区别...</p> <p><strong>构造</strong></p> <p>如上所示，WorkbookWriter 通常将要求在构造函数中指定输出流或文件。</p> <p><strong>提交数据</strong></p> <p>当工作表行准备就绪时，应将其提交，以便可以释放行对象和内容。通常，这将在添加每一行时完成...</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">addRow</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   <span class="token literal-property property">id</span><span class="token operator">:</span> i<span class="token punctuation">,</span>
   <span class="token literal-property property">name</span><span class="token operator">:</span> theName<span class="token punctuation">,</span>
   <span class="token literal-property property">etc</span><span class="token operator">:</span> someOtherDetail
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>WorksheetWriter 在添加行时不提交行的原因是允许单元格跨行合并：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">mergeCells</span><span class="token punctuation">(</span><span class="token string">'A1:B2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'I am merged'</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'C1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'I am not'</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'C2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'Neither am I'</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">getRow</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// now rows 1 and two are committed.</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>每个工作表完成后，还必须提交：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 完成添加数据。 提交工作表</span>
worksheet<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>要完成 XLSX 文档，必须提交工作簿。 如果未提交工作簿中的任何工作表，则将在工作簿提交中自动提交它们。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 完成 workbook.</span>
<span class="token keyword">await</span> workbook<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// ... 流已被写入</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h5 id="流式-xlsx-阅读器⬆"><a href="#流式-xlsx-阅读器⬆" class="header-anchor">#</a> 流式 XLSX 阅读器<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h5> <p>流式 XLSX 工作簿阅读器可以在ExcelJS.stream.xlsx命名空间中找到。</p> <p>构造函数包含必需的输入参数和可选的options参数:</p> <table><thead><tr><th>Argument</th> <th>Description</th></tr></thead> <tbody><tr><td>input (必需的)</td> <td>指定从中读取XLSX工作簿的文件或可读流的名称</td></tr> <tr><td>options (可选的)</td> <td>指定如何处理读取解析期间发生的事件类型</td></tr> <tr><td>options.entries</td> <td>指定是否去触发事件(<code>'emit'</code>)或者不发出事件(<code>'ignore'</code>)，默认值是<code>'emit'</code></td></tr> <tr><td>options.sharedStrings</td> <td>指定是否去缓存(<code>'cache'</code>)共享字符串，将其插入到相应的单元格值中，或者是否去触发(<code>'emit'</code>)或忽略(<code>'ignore'</code>)它们，在这两种情况下，单元格值都将是对共享字符串索引的引用。默认值是<code>'cache'</code></td></tr> <tr><td>options.hyperlinks</td> <td>指定是否去缓存超链接(<code>'cache'</code>)，将其插入到相应的单元格值中，是否去触发(<code>'emit'</code>)或忽略(<code>'ignore'</code>)它们。默认值是<code>'cache'</code></td></tr> <tr><td>options.styles</td> <td>指定是否去缓存样式(<code>'cache'</code>)，将其插入到相应的行或单元格值中，或是否忽略(<code>'忽略'</code>)它们。默认值是<code>'cache'</code></td></tr> <tr><td>options.worksheets</td> <td>指定是否去触发(<code>'emit'</code>)或忽略(<code>'ignore'</code>)工作表。默认值是<code>'emit'</code></td></tr></tbody></table> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span>WorkbookReader</span><span class="token punctuation">(</span><span class="token string">'./file.xlsx'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token keyword">await</span> <span class="token punctuation">(</span><span class="token keyword">const</span> worksheetReader <span class="token keyword">of</span> workbookReader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">for</span> <span class="token keyword">await</span> <span class="token punctuation">(</span><span class="token keyword">const</span> row <span class="token keyword">of</span> worksheetReader<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>请注意，由于性能原因，<code>worksheetReader</code>返回一个行数组，而不是单独返回每一行: https://github.com/nodejs/node/issues/31979</p> <h6 id="迭代遍历所有事件⬆"><a href="#迭代遍历所有事件⬆" class="header-anchor">#</a> 迭代遍历所有事件<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h6> <p>工作簿上的事件是 'worksheet'、'shared-strings' 和 'hyperlinks'。 工作表上的事件是 'row' 和 'hyperlinks'.</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">sharedStrings</span><span class="token operator">:</span> <span class="token string">'emit'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">hyperlinks</span><span class="token operator">:</span> <span class="token string">'emit'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">worksheets</span><span class="token operator">:</span> <span class="token string">'emit'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> workbook <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span>WorkbookReader</span><span class="token punctuation">(</span><span class="token string">'./file.xlsx'</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> <span class="token keyword">await</span> <span class="token punctuation">(</span><span class="token keyword">const</span> <span class="token punctuation">{</span>eventType<span class="token punctuation">,</span> value<span class="token punctuation">}</span> <span class="token keyword">of</span> workbook<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">switch</span> <span class="token punctuation">(</span>eventType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">case</span> <span class="token string">'shared-strings'</span><span class="token operator">:</span>
      <span class="token comment">// 值是共享字符串</span>
    <span class="token keyword">case</span> <span class="token string">'worksheet'</span><span class="token operator">:</span>
      <span class="token comment">// 值是worksheetReader</span>
    <span class="token keyword">case</span> <span class="token string">'hyperlinks'</span><span class="token operator">:</span>
      <span class="token comment">// 值是hyperlinksReader</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h6 id="可读流⬆"><a href="#可读流⬆" class="header-anchor">#</a> 可读流<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h6> <p>我们强烈建议使用异步迭代，但我们也公开了流接口以实现向后兼容性。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">const</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">sharedStrings</span><span class="token operator">:</span> <span class="token string">'emit'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">hyperlinks</span><span class="token operator">:</span> <span class="token string">'emit'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">worksheets</span><span class="token operator">:</span> <span class="token string">'emit'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> workbookReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ExcelJS<span class="token punctuation">.</span>stream<span class="token punctuation">.</span>xlsx<span class="token punctuation">.</span>WorkbookReader</span><span class="token punctuation">(</span><span class="token string">'./file.xlsx'</span><span class="token punctuation">,</span> options<span class="token punctuation">)</span><span class="token punctuation">;</span>
workbookReader<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

workbookReader<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'worksheet'</span><span class="token punctuation">,</span> <span class="token parameter">worksheet</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  worksheet<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'row'</span><span class="token punctuation">,</span> <span class="token parameter">row</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

workbookReader<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'shared-strings'</span><span class="token punctuation">,</span> <span class="token parameter">sharedString</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

workbookReader<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'hyperlinks'</span><span class="token punctuation">,</span> <span class="token parameter">hyperlinksReader</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

workbookReader<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'end'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
workbookReader<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">'error'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br></div></div><h1 id="浏览器⬆"><a href="#浏览器⬆" class="header-anchor">#</a> 浏览器<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h1> <p>该库的一部分已被隔离，并经过测试可在浏览器环境中使用。</p> <p>由于工作簿读写器的流式传输性质，因此未包括这些内容。只能使用基于文档的工作簿（有关详细信息，请参见 <a href="#创建工作簿">创建工作簿</a>）。</p> <p>例如，在浏览器中使用 ExcelJS 的代码可查看 github 中的<a href="https://github.com/exceljs/exceljs/tree/master/spec/browser"> spec / browser </a>文件夹。</p> <h2 id="预捆绑⬆"><a href="#预捆绑⬆" class="header-anchor">#</a> 预捆绑<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>以下文件已预先捆绑在一起，并包含在 <em>dist</em> 文件夹中。</p> <ul><li>exceljs.js</li> <li>exceljs.min.js</li></ul> <h1 id="值类型⬆"><a href="#值类型⬆" class="header-anchor">#</a> 值类型<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h1> <p>支持以下值类型。</p> <h2 id="null-值⬆"><a href="#null-值⬆" class="header-anchor">#</a> Null 值<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>Enum: <code>Excel.ValueType.Null</code></p> <p>空值表示没有值，通常在写入文件时将不存储（合并的单元格除外）。可用于从单元格中删除该值。例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="合并单元格⬆-2"><a href="#合并单元格⬆-2" class="header-anchor">#</a> 合并单元格<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>Enum: <code>Excel.ValueType.Merge</code></p> <p>合并单元格是其值绑定到另一个“主”单元格的单元格。分配给合并单元将导致修改单元格。</p> <h2 id="数字值⬆"><a href="#数字值⬆" class="header-anchor">#</a> 数字值<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>Enum: <code>Excel.ValueType.Number</code></p> <p>一个数字值。</p> <p>例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">3.14159</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="字符串值⬆"><a href="#字符串值⬆" class="header-anchor">#</a> 字符串值<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>Enum: <code>Excel.ValueType.String</code></p> <p>一个简单的文本字符串。</p> <p>例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token string">'Hello, World!'</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="日期值⬆"><a href="#日期值⬆" class="header-anchor">#</a> 日期值<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>Enum: <code>Excel.ValueType.Date</code></p> <p>日期值，由 JavaScript Date 类型表示。</p> <p>例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token number">2017</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="超链接值⬆"><a href="#超链接值⬆" class="header-anchor">#</a> 超链接值<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>Enum: <code>Excel.ValueType.Hyperlink</code></p> <p>具有文本和链接值的 URL。</p> <p>例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 链接到网络</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'www.mylink.com'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">hyperlink</span><span class="token operator">:</span> <span class="token string">'http://www.mylink.com'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">tooltip</span><span class="token operator">:</span> <span class="token string">'www.mylink.com'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 内部链接</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'Sheet2'</span><span class="token punctuation">,</span> <span class="token literal-property property">hyperlink</span><span class="token operator">:</span> <span class="token string">'#\'Sheet2\'!A1'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="公式值⬆"><a href="#公式值⬆" class="header-anchor">#</a> 公式值<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>Enum: <code>Excel.ValueType.Formula</code></p> <p>一个 Excel 公式，用于即时计算值。请注意，虽然单元格类型将为“公式”，但该单元格可能具有一个有效类型值，该值将从结果值中得出。</p> <p>请注意，ExcelJS 无法处理公式以生成结果，必须提供该公式。</p> <p>例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">formula</span><span class="token operator">:</span> <span class="token string">'A1+A2'</span><span class="token punctuation">,</span> <span class="token literal-property property">result</span><span class="token operator">:</span> <span class="token number">7</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>单元格还支持便捷的获取器，以访问公式和结果：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>formula <span class="token operator">===</span> <span class="token string">'A1+A2'</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>result <span class="token operator">===</span> <span class="token number">7</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="共享公式⬆"><a href="#共享公式⬆" class="header-anchor">#</a> 共享公式<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>共享的公式通过减少工作表 xml 中文本的重复来增强 xlsx 文档的压缩。范围中左上角的单元格是指定的母版，它将保留该范围内的所有其他单元格都将引用的公式。然后，其他“从属”单元格可以引用此主单元格，而不必再次重新定义整个公式。请注意，主公式将以常用的 Excel 方式转换为从属单元格，以便对其他单元格的引用将根据从属单元相对于主单元的偏移量向右下移。例如：如果主单元格A2具有引用A1的公式，则如果单元格B2共享A2的公式，则它将引用B1。</p> <p>可以将主公式与该范围内的从属单元格一起分配给该单元格</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">formula</span><span class="token operator">:</span> <span class="token string">'A1'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">result</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token literal-property property">shareType</span><span class="token operator">:</span> <span class="token string">'shared'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'A2:B3'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>可以使用新的值形式将共享公式分配给单元格：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">sharedFormula</span><span class="token operator">:</span> <span class="token string">'A2'</span><span class="token punctuation">,</span> <span class="token literal-property property">result</span><span class="token operator">:</span> <span class="token number">10</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这指定单元格B2是将从A2中的公式派生的公式，其结果为10。</p> <p>公式便捷获取器会将A2中的公式转换为B2中应具有的公式：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">expect</span><span class="token punctuation">(</span>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>formula<span class="token punctuation">)</span><span class="token punctuation">.</span>to<span class="token punctuation">.</span><span class="token function">equal</span><span class="token punctuation">(</span><span class="token string">'B1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>可以使用 <code>fillFormula</code> 方法将共享的公式分配到工作表中：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 将 A1 设置为起始编号</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token comment">// 从 A1 开始以递增计数将 A2 填充到 A10</span>
worksheet<span class="token punctuation">.</span><span class="token function">fillFormula</span><span class="token punctuation">(</span><span class="token string">'A2:A10'</span><span class="token punctuation">,</span> <span class="token string">'A1+1'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token number">7</span><span class="token punctuation">,</span><span class="token number">8</span><span class="token punctuation">,</span><span class="token number">9</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><code>fillFormula</code> 也可以使用回调函数来计算每个单元格的值</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 从A1开始以递增计数将 A2 填充到 A100</span>
worksheet<span class="token punctuation">.</span><span class="token function">fillFormula</span><span class="token punctuation">(</span><span class="token string">'A2:A100'</span><span class="token punctuation">,</span> <span class="token string">'A1+1'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">row<span class="token punctuation">,</span> col</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> row<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="公式类型⬆"><a href="#公式类型⬆" class="header-anchor">#</a> 公式类型<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>要区分真正的和转换后的公式单元格，请使用 FormulaType getter：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>formulaType <span class="token operator">===</span> Enums<span class="token punctuation">.</span>FormulaType<span class="token punctuation">.</span>Master<span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'B3'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>formulaType <span class="token operator">===</span> Enums<span class="token punctuation">.</span>FormulaType<span class="token punctuation">.</span>Shared<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>公式类型具有以下值：</p> <table><thead><tr><th>名称</th> <th>值</th></tr></thead> <tbody><tr><td>Enums.FormulaType.None</td> <td>0</td></tr> <tr><td>Enums.FormulaType.Master</td> <td>1</td></tr> <tr><td>Enums.FormulaType.Shared</td> <td>2</td></tr></tbody></table> <h3 id="数组公式⬆"><a href="#数组公式⬆" class="header-anchor">#</a> 数组公式<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>在 Excel 中表示共享公式的一种新方法是数组公式。以这种形式，主单元格是唯一包含与公式有关的任何信息的单元格。它包含 shareType 'array' 以及适用于其的单元格范围以及将要复制的公式。其余单元格是具有常规值的常规单元格。</p> <p>注意：数组公式不会以共享公式的方式转换。因此，如果主单元A2引用A1，则从单元B2也将引用A1。</p> <p>例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 将数组公式分配给 A2:B3</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">formula</span><span class="token operator">:</span> <span class="token string">'A1'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">result</span><span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span>
  <span class="token literal-property property">shareType</span><span class="token operator">:</span> <span class="token string">'array'</span><span class="token punctuation">,</span>
  <span class="token literal-property property">ref</span><span class="token operator">:</span> <span class="token string">'A2:B3'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token comment">// 可能没有必要填写工作表中的其余值</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><code>fillFormula</code> 方法也可以用于填充数组公式</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 用数组公式 &quot;A1&quot; 填充 A2:B3</span>
worksheet<span class="token punctuation">.</span><span class="token function">fillFormula</span><span class="token punctuation">(</span><span class="token string">'A2:B3'</span><span class="token punctuation">,</span> <span class="token string">'A1'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token string">'array'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="富文本值⬆"><a href="#富文本值⬆" class="header-anchor">#</a> 富文本值<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>Enum: <code>Excel.ValueType.RichText</code></p> <p>样式丰富的文本。</p> <p>例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">richText</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'This is '</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token literal-property property">font</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">italic</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'italic'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="布尔值⬆"><a href="#布尔值⬆" class="header-anchor">#</a> 布尔值<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>Enum: <code>Excel.ValueType.Boolean</code></p> <p>例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="错误值⬆"><a href="#错误值⬆" class="header-anchor">#</a> 错误值<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>Enum: <code>Excel.ValueType.Error</code></p> <p>例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A1'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">'#N/A'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
worksheet<span class="token punctuation">.</span><span class="token function">getCell</span><span class="token punctuation">(</span><span class="token string">'A2'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token literal-property property">error</span><span class="token operator">:</span> <span class="token string">'#VALUE!'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>当前有效的错误文本值为：</p> <table><thead><tr><th>名称</th> <th>值</th></tr></thead> <tbody><tr><td>Excel.ErrorValue.NotApplicable</td> <td>#N/A</td></tr> <tr><td>Excel.ErrorValue.Ref</td> <td>#REF!</td></tr> <tr><td>Excel.ErrorValue.Name</td> <td>#NAME?</td></tr> <tr><td>Excel.ErrorValue.DivZero</td> <td>#DIV/0!</td></tr> <tr><td>Excel.ErrorValue.Null</td> <td>#NULL!</td></tr> <tr><td>Excel.ErrorValue.Value</td> <td>#VALUE!</td></tr> <tr><td>Excel.ErrorValue.Num</td> <td>#NUM!</td></tr></tbody></table> <h1 id="接口变化⬆"><a href="#接口变化⬆" class="header-anchor">#</a> 接口变化<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h1> <p>我们会尽一切努力创建一个良好的，一致的接口，该接口不会在版本之间不兼容，但令人遗憾的是，为了实现更大的利益，有时需要进行一些更改。</p> <h2 id="_0-1-0⬆"><a href="#_0-1-0⬆" class="header-anchor">#</a> 0.1.0<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <h3 id="worksheet-eachrow⬆"><a href="#worksheet-eachrow⬆" class="header-anchor">#</a> Worksheet.eachRow<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>在 <code>Worksheet.eachRow</code> 的回调函数中的参数已被交换和更改；它是 <code>function(rowNumber，rowValues)</code>，现在是 <code>function(row，rowNumber)</code>，使它的外观更像 <em>underscore(<code>_.each</code>)方法，并且行对象优先于行号。</em></p> <h3 id="worksheet-getrow⬆"><a href="#worksheet-getrow⬆" class="header-anchor">#</a> Worksheet.getRow<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p>此函数已从返回稀疏的单元格数组更改为返回 <code>Row</code> 对象。这样可以访问行属性，并有助于管理行样式等。</p> <p>仍可通过 <code>Worksheet.getRow(rowNumber).values;</code> 获得稀疏的单元格值的数组。</p> <h2 id="_0-1-1⬆"><a href="#_0-1-1⬆" class="header-anchor">#</a> 0.1.1<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <h3 id="cell-model⬆"><a href="#cell-model⬆" class="header-anchor">#</a> cell.model<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h3> <p><code>cell.styles</code> 重命名为 <code>cell.style</code></p> <h2 id="_0-2-44⬆"><a href="#_0-2-44⬆" class="header-anchor">#</a> 0.2.44<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>从 Bluebird 切换到 Node 原生 Promise 的函数返回的 Promise 如果依赖 Bluebird 的额外功能，则可能会破坏调用代码。</p> <p>为了减少这种情况的出现，在0.3.0中添加了以下两个更改：</p> <ul><li>默认情况下使用功能更全且仍与浏览器兼容的 promise lib。 该库支持 Bluebird 的许多功能，但占用空间少得多。</li> <li>注入其他 Promise 实现的选项。有关更多详细信息，请参见<a href="#配置">配置</a>部分。</li></ul> <h1 id="配置⬆"><a href="#配置⬆" class="header-anchor">#</a> 配置<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h1> <p>ExcelJS现在支持对 Promise 库的依赖项注入。您可以通过在模块中包含以下代码来还原 Bluebird Promise。</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>ExcelJS<span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token string">'promise'</span><span class="token punctuation">,</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'bluebird'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>请注意：我已经使用 bluebird 专门测试了 ExcelJS（直到最近，这是它使用的库）。根据我所做的测试，它不适用于 Q。</p> <h1 id="注意事项⬆"><a href="#注意事项⬆" class="header-anchor">#</a> 注意事项<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h1> <h2 id="dist-文件夹⬆"><a href="#dist-文件夹⬆" class="header-anchor">#</a> Dist 文件夹<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>在发布此模块之前，先对源代码进行编译和其他处理，然后再将它们放置在 <em>dist/</em> 文件夹中。该自述文件标识两个文件-浏览器捆绑和压缩版本。除了在 package.json 中指定为  <code>&quot;main&quot;</code> 的文件外，不能保证 <em>dist/</em> 文件夹的其他内容。</p> <h1 id="已知的问题⬆"><a href="#已知的问题⬆" class="header-anchor">#</a> 已知的问题<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h1> <h2 id="使用-puppeteer-进行测试⬆"><a href="#使用-puppeteer-进行测试⬆" class="header-anchor">#</a> 使用 Puppeteer 进行测试<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>该 lib 中包含的测试套件包括一个在无头浏览器中执行的小脚本，以验证捆绑的软件包。 在撰写本文时，其表现出该测试在 Windows Linux 子系统中不能很好地进行。</p> <p>因此，可以通过存在名为 <em>.disable-test-browser</em> 的文件来禁用浏览器测试。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> libfontconfig
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="拼接与合并⬆"><a href="#拼接与合并⬆" class="header-anchor">#</a> 拼接与合并<a href="#%E7%9B%AE%E5%BD%95">⬆</a></h2> <p>如果任何 <code>splice</code> 操作影响合并的单元格，则合并组将无法正确移动</p></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/Jonathan-Rao/rdk-blog-dist/edit/master/docs/_posts/前端/exceljs（前端导出excel）插件API文档.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/tags/?tag=vue" title="标签">#vue</a><a href="/tags/?tag=exceljs" title="标签">#exceljs</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/09/29, 9:09:00</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/eabcb8/"><div>
            前端工程师生产环境 debugger 技巧
            <!----></div></a> <span class="date">10-17</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/2dd8e1/"><div>
            独立开发者资源
            <!----></div></a> <span class="date">09-05</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/1bf551/"><div>
            Vis-Network中文API文档
            <!----></div></a> <span class="date">09-29</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:515977826@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Jonathan-Rao" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/#/playlist?id=755597173" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2025
    <span>DK Rao | MIT License</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.63f7405e.js" defer></script><script src="/assets/js/3.4c003ae3.js" defer></script><script src="/assets/js/2.1e9afdb9.js" defer></script><script src="/assets/js/60.3494f023.js" defer></script>
  </body>
</html>
